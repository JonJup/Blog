<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Constrained Quadratic Ordination</title>
    <meta charset="utf-8" />
    <meta name="author" content="Jonathan Jupke" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="libs/sydney.css" type="text/css" />
    <link rel="stylesheet" href="libs/sydney-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Constrained Quadratic Ordination
## MOD3: Advanced data science
### Jonathan Jupke
### University of Koblenz-Landau
### 2021/01/07

---

&lt;style type="text/css"&gt;
.remark-code { font-family: 'Source Code Pro', 'Lucida Console', Monaco, monospace;
                                    font-size: 100%;
                                  }
}
&lt;/style&gt;



# Constrained Quadratic Ordination 

- model-based constrained .blue[ordination]

--

- something is .blue[quadratic]

--

- we fit models, but with .blue[latent variables] 

--

.blockquote[
### <i class="fas  fa-comment-dots "></i> Question
What are latent variables? 
]

--

&lt;blockquote&gt;
A variable that cannot be measured directly, but is assumed to be related to a number of observable or manifest variables.
.right[-- &lt;cite&gt;Everitt &amp; Skrondal (2010) &lt;/cite&gt;]
&lt;/blockquote&gt;

--

- like axes in a PCA

---

# Vector Generalized linear models 

.footnote[see Dobson &amp; Barnett (2018) for more on the exponential family]

<i class="fas  fa-comment "></i><i class="fas  fa-box " style="color:white;"></i> proposed by Yee &amp; Wild (1996)

--

<i class="fas  fa-plus "></i><i class="fas  fa-box " style="color:white;"></i> extend of GLM 

--

<i class="fas  fa-box "></i><i class="fas  fa-box " style="color:white;"></i> GLMs are restricted to distributions from the .blue[exponential family].    

--

<i class="fas  fa-box-open "></i><i class="fas  fa-box " style="color:white;"></i>VGLMs are not.  

--

<i class="fas  fa-boxes "></i><i class="fas  fa-box " style="color:white;"></i> VGLMs can have .blue[multiple linear predictors], for different parameters.

--

<i class="fas  fa-clone "></i><i class="fas  fa-box " style="color:white;"></i> Explanatory variables can differ between predictors.

---
# Distributional Models 
.footnote[see [here](https://paul-buerkner.github.io/brms/articles/brms_distreg.html) for more on distributional models in R]

--

.content-box-blue[OLS] 
`$$y_i \sim N(\mu = \alpha + \beta_1 x_1, \sigma^2)$$`
--

.content-box-blue[distributional model] 
`$$y_i \sim N(\mu = \alpha_\mu + \beta_{\mu_1}x_1, \sigma^2 = \alpha_\sigma + \beta_{\sigma}x_1)$$`
--

`$$y_i \sim N(\mu = \alpha_\mu + \beta_{\mu}x_1, \sigma^2 = \alpha_\sigma + \beta_{\sigma}x_2)$$`
--

.blockquote[
  ### <i class="fas  fa-spinner fa-2x fa-spin "></i> Variation-explicit ecology 
  Modeling and thinking about variances instead of means.  
  See Holyoak &amp; Wetzel (2020)
]

---

# Reduced Rank VGLM  

<i class="fas  fa-arrow-down "></i> Reduce the dimensions of **X** with Reduced Rank Regression   

--

`$$x^\prime_{ir} = \Sigma_{p=1}^P w_{rp}x_{ip}$$` 
w - .blue[constrained coefficients]


--

$$L = \beta x_1 + \beta^\prime x^\prime $$
`\(x_1\)` contains variables not considered in the RRR (e.g. intercept)

--

.blockquote[
  ### <i class="fas  fa-spinner fa-2x fa-spin "></i> still processing 
  Preselecting variables for latent variables based on theory
]

---

.footnote[Yee (2015)]

# Quadratic RR-VGLM

In ecology, unimodal responses are the norm (Oksanen &amp; Minchin, 2002)  

&lt;img src="figures/yee15_1.png" width="387" style="display: block; margin: auto;" /&gt;


--

`\begin{align}
L    &amp;= \beta x_1 + \beta^\prime x^\prime  &amp; ordinary\ RR-VGLM \\
L    &amp;= \beta x_1 + \beta^\prime x^\prime + \beta^{\prime\prime} \ x^{\prime 2} &amp; quadratic\ RR-VGLM\ (CQO)
\end{align}`

---
.footnote[Gauch &amp; Whittaker (1972), ter Braak (1986), Yee (2004), Zuur et al. (2007)]

# Gaussian Regression 

`$$Y_{is} = c_s\ exp\bigg(- \frac{(x_{ip} - u_{sp})^2}{2t_{sp}^2}\bigg) \text{  Gaussian Response Model}$$`

--

`$$P(x|\mu,\sigma) = \frac{1}{\sigma\sqrt{2\pi}} exp\bigg( -\frac{(x-\mu)^2}{2\sigma^2} \bigg) \text{  Normal Distribution}$$`

--

As GLM:
`\begin{align}
y_{is} &amp;= exp \bigg(ln(c_s) - \frac{u_{sp}^2}{2t_{sp}^2} &amp;+ \frac{u_{sp}}{t_{sp}^2}x_{ip} &amp;- \frac{1}{2t_{sp}^2}x^2_{ip}\bigg)\\
       &amp;= exp(b_{1s} &amp;+ b_{sp}\ x_{ip} &amp;+ b_{2sp}\ x_{ip}^2)
\end{align}`

--

- CCA aproximates this, given a set of restrictive assumptions 
- CQO estimates parameters with MLE (IRLS)


---
# Hunting Spider Data

from ter Braak (1986)  



&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:700px; "&gt;&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; WaterCon &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; BareSand &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; FallTwig &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; CoveMoss &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; CoveHerb &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; ReflLux &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Alopacce &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Alopcune &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Alopfabr &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Arctlute &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Arctperi &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Auloalbi &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardlugu &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardmont &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardnigr &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardpull &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Trocterr &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Zoraspin &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.3321 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.4543 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9120 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 45 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 57 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0493 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6094 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.5572 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6052 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 45 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.6741 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.9957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 94 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 86 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0155 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 135 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 76 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 91 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.3810 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.1781 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 89 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 105 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 118 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.6247 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.2627 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.4849 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3307 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.1972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9318 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.2192 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.1109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.7136 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.2925 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.8286 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.5175 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 43 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0865 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 94 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.2696 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0301 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6052 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.3322 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.4543 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.1224 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.9232 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6094 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6094 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.1091 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5951 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.9755 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.2528 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3307 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9120 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.1939 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0943 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.6487 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0073 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.8245 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.5835 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.1109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9933 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3820 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9555 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.8286 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9555 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.7136 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;

---

# Rank-1 Poisson CQO


```r
set.seed(1234)
hspider[, 1:6] &lt;- scale(hspider[, 1:6]) # Standardized environmental variables
r1_p_it &lt;- cqo(cbind(Alopacce, Alopcune, Alopfabr, Arctlute, 
                     Arctperi, Auloalbi, Pardlugu, Pardmont, 
                     Pardnigr, Pardpull, Trocterr, Zoraspin) ~
                 WaterCon + BareSand + FallTwig + 
                 CoveMoss + CoveHerb + ReflLux,
               family = "poissonff",
               data = hspider,
               eq.toler = TRUE,
               I.tolerances = TRUE,
               trace = FALSE,
               Rank = 1)
```



---

# What model fits best? 

.scroll-output[

```r
cqo_resid_plot(list(cqo_list$r1_p_i, 
                    cqo_list$r1_p_e,
                    cqo_list$r1_p_u),
               smooth = F)
```

&lt;img src="mod3-3-cqo_files/figure-html/cqo_residual plots-1.png" style="display: block; margin: auto;" /&gt;
]

---

# What model fits best? 
.scroll-output[

```r
cqo_resid_plot(list(cqo_list$r1_p_e, 
                    cqo_list$r1_nb_e, 
                      cqo_list$r1_nb_u), smooth = F, logx=T)
```

&lt;img src="mod3-3-cqo_files/figure-html/cqo_residual plots2-1.png" style="display: block; margin: auto;" /&gt;
]

---

# What model fits best? 

```r
BIC(cqo_list$r1_p_e)
```

```
## [1] 2386.548
```

```r
BIC(cqo_list$r1_p_u)
```

```
## [1] 2014.091
```

```r
BIC(cqo_list$r1_p_i)
```

```
## [1] 2386.551
```

---
# Perspective Plot 

&lt;img src="mod3-3-cqo_files/figure-html/CQO persp plot-1.png" style="display: block; margin: auto;" /&gt;

---
# Constrained Coefficients

```r
concoef(cqo_list$r1_nb_u) 
```

```
##               latvar
## WaterCon  0.30544860
## BareSand -0.29836536
## FallTwig  0.63408593
## CoveMoss -0.58402515
## CoveHerb  0.09017576
## ReflLux  -0.18312829
```

--
.scroll-output[

```r
Tol(cqo_list$r1_nb_u)[1, 1, ]
```

```
##    Alopacce    Alopcune    Alopfabr    Arctlute    Arctperi    Auloalbi 
##  1.00000000  0.55581431  5.42432396  0.11220232  0.08159341  0.32064246 
##    Pardlugu    Pardmont    Pardnigr    Pardpull    Trocterr    Zoraspin 
## -2.98236514  0.60281639  0.26048641  0.25078285  0.77464761  0.42526092
```
]
---

# Let's add a second gradient


```r
cqo(cbind(Alopacce, Alopcune, Alopfabr,
                     Arctlute, Arctperi, Auloalbi,
                     Pardlugu, Pardmont, Pardnigr,
                     Pardpull,Trocterr, Zoraspin) ~
                       WaterCon + BareSand + FallTwig +
                       CoveMoss + CoveHerb + ReflLux,
               family = poissonff,
               data = hspider,
               Rank = 2,
               I.toler = TRUE,
               Bestof = 2)
```

---

# What model fits best

.scroll-output[

```r
cqo_resid_plot(list(cqo_list$r2_p_i, 
                    cqo_list$r2_p_e,
                    cqo_list$r2_p_u),
               smooth = F, logx = TRUE)
```

&lt;img src="mod3-3-cqo_files/figure-html/cqo_rank2_residual plots-1.png" style="display: block; margin: auto;" /&gt;
]
---

# What model fits best

.scroll-output[

```r
cqo_resid_plot(list(cqo_list$r2_nb_e, 
                    cqo_list$r2_p_e,
                    cqo_list$r2_p_u),
               smooth = F, logx = TRUE)
```

&lt;img src="mod3-3-cqo_files/figure-html/cqo_rank2_residual plots2-1.png" style="display: block; margin: auto;" /&gt;
]
---

# Rank 2 Latent Variable Plot 
        
&lt;img src="mod3-3-cqo_files/figure-html/2d latent variable plot-1.png" style="display: block; margin: auto;" /&gt;

---
# 3d Perspective plot
&lt;img src="mod3-3-cqo_files/figure-html/CQO 2d persp plot-1.png" style="display: block; margin: auto;" /&gt;
---
# Extended ouput 
        
.scroll-output[

```r
coef(cqo_list$r2_p_i)
```

```
## 
## C matrix (constrained/canonical coefficients)
##             latvar1    latvar2
## WaterCon  0.1689762  0.8360904
## BareSand -0.7532784 -0.1229943
## FallTwig  0.9029580 -0.2083737
## CoveMoss -0.3604176  0.9244204
## CoveHerb  0.2518191 -0.3764665
## ReflLux  -0.5651024 -0.0516556
## 
## B1 and A matrices
##                      (Intercept)  A.latvar1  A.latvar2
## loglink(E[Alopacce])   1.8976498 -1.7556516 -0.2166625
## loglink(E[Alopcune])   2.9238017  0.3106442 -0.5887788
## loglink(E[Alopfabr])  -1.3479174 -2.8731320 -0.3528537
## loglink(E[Arctlute])   1.0510048  0.5980197 -0.1684576
## loglink(E[Arctperi])  -9.1421277 -5.0693186 -0.9439741
## loglink(E[Auloalbi])   2.6162000  0.5732683 -0.7427831
## loglink(E[Pardlugu])  -0.5396072  2.4818254 -1.0679044
## loglink(E[Pardmont])   3.5351235 -0.9690482  0.7136484
## loglink(E[Pardnigr])   3.6599937  0.4317611 -1.4133555
## loglink(E[Pardpull])   4.2914157  0.2820810 -0.5162568
## loglink(E[Trocterr])   4.5119514  0.8107997 -0.3083447
## loglink(E[Zoraspin])   2.8942183  0.7739932  0.1011200
## 
## Optimums and maximums
##          Optimum.latvar1 Optimum.latvar2   Maximum
## Alopacce      -1.7556516      -0.2166625  31.88952
## Alopcune       0.3106442      -0.5887788  23.22854
## Alopfabr      -2.8731320      -0.3528537  17.14624
## Arctlute       0.5980197      -0.1684576   3.46949
## Arctperi      -5.0693186      -0.9439741  63.58714
## Auloalbi       0.5732683      -0.7427831  21.25053
## Pardlugu       2.4818254      -1.0679044  22.42847
## Pardmont      -0.9690482       0.7136484  70.76028
## Pardnigr       0.4317611      -1.4133555 115.81445
## Pardpull       0.2820810      -0.5162568  86.87420
## Trocterr       0.8107997      -0.3083447 132.71284
## Zoraspin       0.7739932       0.1011200  24.50467
## 
## Tolerances
##          tol1 tol2
## Alopacce    1    1
## Alopcune    1    1
## Alopfabr    1    1
## Arctlute    1    1
## Arctperi    1    1
## Auloalbi    1    1
## Pardlugu    1    1
## Pardmont    1    1
## Pardnigr    1    1
## Pardpull    1    1
## Trocterr    1    1
## Zoraspin    1    1
## 
## Standard deviation of the latent variables (site scores)
##   latvar1   latvar2 
## 2.2587634 0.7340673
```
                
]

---

# Constained Additive Ordination 

In addition to VGLMs, additive models (VGAMs) can be fitted.  

--


<i class="fab  fa-r-project "></i> <i class="fab  fa-r-project " style="color:white;"></i> Syntax similar to CQO 

--

<i class="fas  fa-plus "></i> <i class="fab  fa-r-project " style="color:white;"></i> new argument: *df1.nl* : .blue[effective non-linear degrees of freedom]  

--

<i class="fas  fa-chart-line "></i> <i class="fab  fa-r-project " style="color:white;"></i> controls how smooth the output is (0 = linear)

--

<i class="fas  fa-sad-tear "></i> <i class="fab  fa-r-project " style="color:white;"></i> only rank 1 models implemented 

--

<i class="fas  fa-times "></i> <i class="fab  fa-r-project " style="color:white;"></i> no tolerance assumptions 

--


<i class="fas  fa-cogs "></i> <i class="fab  fa-r-project " style="color:white;"></i> can be used to .blue[check unimodality]



---
        
# CAO single species plots

.scroll-output[
&lt;img src="mod3-3-cqo_files/figure-html/cao plot-1.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-2.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-3.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-4.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-5.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-6.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-7.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-8.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-9.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-10.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-11.png" style="display: block; margin: auto;" /&gt;&lt;img src="mod3-3-cqo_files/figure-html/cao plot-12.png" style="display: block; margin: auto;" /&gt;
]

---
        
# CAO Latent variable Plot 
&lt;img src="mod3-3-cqo_files/figure-html/cao persp-1.png" style="display: block; margin: auto;" /&gt;
---
# In practice 

- They are .blue[not commonly used]

--
        
-  single GLMs predict species ranges better (Baselga &amp; Araújo, 2009)

--
        
- CQO better for rare species (Bonthoux *et al.* 2013) 

--

- manyglms differentiated between noise and causal variables better than CQO (Jupke &amp; Schäfer, 2020)

--
        
- CQO and CAO predict better (but still bad) than GLM and GAM to dissimilar conditions (Maguire *et. al.*, 2016) 

--
        
- some applied studies mostly with fish (e.g. Vilizzi et al. (2012))

--
        
&lt;blockquote&gt;
limitations on the number of species, steepness of the learning curve and low numerical stability of the algorithm
.right[-- &lt;cite&gt;ter Braak &amp; Šmilauer 2015&lt;/cite&gt;]
&lt;/blockquote&gt;

---

# However ... Ovaskainen *et al*. 2017b

.scroll-output[
&lt;img src="figures/ovaskainen2017_3.jpg" width="1633" style="display: block; margin: auto;" /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
