[["index.html", "Einführung in GIS - QGIS 1 Intro", " Einführung in GIS - QGIS Jonathan Jupke 2023-04-18 1 Intro Willkommen im Skript für den praktischen Teil der Vorlesung Einführung in Geographische Informationssysteme an der RPTU. In diesem Skript werden wir nach und nach verschiedene Funktionen der QGIS Software kennenlernen und in Beispielaufgaben ausprobieren. QGIS entwickelt sich stetig weiter. Einerseits ist das super, da neue Funktionen hinzukommen und alte Fehler behoben werden, aber andererseits ändern sich manchmal die Namen von Knöpfen, Reitern und Funktionen. Falls ihr die von mir beschriebenen Abläufe nicht im Programm nachvollziehen könnt, kann es also an mir, QGIS oder euch liegen. So oder so einfach nachfragen. Falls ihr Schriftart oder -größe ändern wollt, oben links das A. Wenn Abbildungen zu klein sind könnt ihr sie mit Rechtsklick in einem neuen Tab öffnen. Links seht ihr eine Übersicht über alle Kapitel, die ihr mit einem Klick auf die vier waagerechten Balken daneben verschwinden lassen könnt. "],["erste-schritte.html", "2 Erste Schritte 2.1 QGIS installieren 2.2 Was sehe ich hier? 2.3 Wie lade ich Daten? 2.4 Projekte 2.5 Plug-ins", " 2 Erste Schritte 2.1 QGIS installieren Falls ihr QGIS noch nicht installiert habt ist das natürlich der erste Schritt. Geht auf diese (Website)[https://www.qgis.org/en/site/]. Oft gibt es verschiedene Versionen, ich würde hier empfehlen immer die LTR (Long Term Release) Version zu nutzen. Diese Versionen werden länger aktiv unterstützt und haben alles in allem daher weniger Fehler. 2.2 Was sehe ich hier? Mein QGIS ist auf Englisch eingestellt. Falls dich der Sprachunterschied stört, kannst du die Sprache deines QGIS ändern unter Settings \\(\\rightarrow\\) Options (Abb. 2.1). Figure 2.1: Allgmeine Optionen öffnen um die Sprache zu ändern Dort links den obersten Eintrag General wählen und die Sprache ändern. Allerdings nur im oberen Feld (user interface translation). Das Feld darunter sollte auf Germany eingestellt bleiben. Nachdem ihr QGIS das erste Mal geöffnet habt erscheint das folgende Fenster (Abb. 2.2). Figure 2.2: QGIS Vermutlich sieht das Fenster bei euch ein wenig anders aus, ihr werdet z.B. ein paar Schaltflächen und Fenster weniger haben, aber die enscheidenden Bestandteile sind die gleichen. Im Browser Panel (blau in Abb. 2.2) seht ihr die Ordner eures PCs. Hier könnt ihr zu Dateien navigieren die ihr öffnen wollt und diese mit einem Doppelklick laden. Falls es einen Ordner gibt auf den ihr besonders oft zugreift, könnt ihr ihn als Favoriten markieren (Abb. 2.3). Favorieten werden ganz oben im Browser Panel angezeigt, so könnt ihr einfach und schnell zu ihnen navigieren ohne euch durch eure komplette Ordnerstruktur klicken zu müssen. Ein neu als Favorit markierter Ordner bekommt seinen Pfad als Namen. Bei mir ist das “C:\\Users\\jonat\\Documents\\Uni\\teaching\\GIS\\landau_bachelor_1\\SS22\\MSI2_data”. Wir können den Namen ändern indem wir den Favoriten auswählen und dann F2 drücken oder mit Rechtsklick \\(\\rightarrow\\) Rename Favorite…. Figure 2.3: Ordner als Favorit markieren Aufgabe Ladet die Dateien libellen.zip, rivers_rlp.zip und Landschaftseinheiten.zip hier herunter. Erstellt einen Ordner den ihr für alle Dateien dieser Vorlesung benutzen könnt. Macht diesen Ordner zu einem Favoriten. Entzippt die heruntergeladenen Dateien und speichert sie in dem neuen Ordner. Öffnet die drei Layer in QGIS indem ihr jeweils auf die .shp Dateien doppelklickt. Falls ihr Hilfe beim entzippen der Datein braucht seht hier (Windows) oder hier. Unter dem Browser Panel ist das Layer Panel (orange Abb. 2.2). Hier werden alle Datein angezeigt die ihr aktuell in QGIS geladen habt. Wenn ihr das Programm startet ist der Layer Panel dementsprechend noch leer. Nachdem ihr die drei Layer geladen habt sollten diese dort aufgeführt werden (Abb. 2.4). Figure 2.4: QGIS mit geladenen Layern In der Mitte des Bildschirms (dem Map View) werden euch die Daten nun angezeigt. Die Farben werden jedesmal beim Laden zufällig ausgewähl also seht ihr bei euch vermutlich andere Farben. Jeder Layer hat im Layer Panel drei Spalten. Erstens ein Box mit Hacken. Wenn ihr diesen Hacken mit einem Linksklick entfernt wird der Layer nicht mehr angezeigt. Zweitens eine farbige geometrische Form. Diese zeigt die feature class (also Punkt, Linie oder Polygon) des Layers sowie seine Symoblogie (Farbe und Form der Darstellung) an. Als drittes seht ihr den Namen des Layers. Dieser kann genau wie bei den Ordnern im Browser Panel per Rechtsklick oder F2 geändert werden. Die Reihenfolge der Layer im Layer Panel entspricht der Reihenfolge der Layer im Map View. Wenn der Polygonlayer Landschaftseinheiten im Layer Panel über dem Punktlayer artenfinder_libellen_rlp liegt so liegt er auch im Map View darüber und wir können die Punkte unter dem Polygon nicht sehen. Das letzte wichtige Element der graphischen Oberfläche von QGIS ist die Menüleiste (grün Abb. 2.2). Im Folgenden werde ich die wichtigen Elemente der Menüleisste kurz vorstellen. Einige der Elemente sind für diese Vorlesung nicht relevant und werden hier nicht besprochen, andere kommen in späteren Abschnitten vor. Mit öffnet ihr ein neues QGIS Projekt, das aktuelle wird dabei geschlossen. Mit öffnet ihr ein existierendes QGIS Projekt. Mit öffnet ihr den Print Composer. Mehr zum Print Composer hier. Mit wählt ihr das Pan (schwenken) Werkzeug aus. Damit könnt ihr die Ansicht im Map View ändern, indem ihr die Maus über den Map View bringt, die linke Maustaste gedrückt haltet und die Maus bewegt. Mit dem Mausrad könnt ihr rein und raus zoomen. Zoomen könnt ihr auch mit und . Dafür das Werkzeug auswählen und dann auf den Map View klicken um rein () oder raus () zuzommen. Mit können wir genau auf den aktuellen Layer zoomen. Mit dieser Funktion stellen wir die Zoomstufe so ein, das wir alle Daten des im Layer Panel gewählten Layers sehen können. Mit und könnt ihr zwischen Zoomstufen springen. Falls euch ein Map View nicht ausreicht könnt ihr mit einen zweiten (dritten, vierten, …) Map View erstellen. Dieser erscheint als verschiebares Fenster. Mit können wir einzelne Elemente im Map View auswählen und erhalten deren Eintrag aus der Attributtabelle. Mit dem Field Calculator () können wir der Attributtabelle neue Spalten hinzufügen. Den Field Calculator betrachten wir hier näher. Mit öffnen wir die Processing Toolbox. Mit können wir einige statistische Zusammenfassungen unseres Layers berechnen. Das Fenster öffnet sich unterhalb des Layer Panels (Abb. 2.5). Im obersten Menü (blau in 2.5) wählen wir den Layer, darunter (orange in 2.5) die Variable, also die Spalte der Attributtabelle und darunter (grün in 2.5) werden die Ergebnisse angezeigt. Mit können wir die Attributtabelle eines Layers öffnen. Mit können wir Distanzen, Flächen, Himmelsrichtungen und Winekl auf der Karte messen. Figure 2.5: Zusammenfassende Statistiken 2.3 Wie lade ich Daten? Wie Daten einfach über das Browser Panel geladen werden können haben wir bereits gesehen. Alternativ könnt ihr Dateien auch per Drag-and-Drop aus dem Browser eures Betriebssystems in QGIS ziehen (Map View oder Layer Panel). Die dritte Möglichkeit stellt der Data Source Manager dar. Ihr findet ihn unter Layer \\(\\rightarrow\\) Data Source Manager (Abb. 2.6) oder mit Strg + L. Figure 2.6: Pfad zum Data Source Manager Auf der rechten Seite des Data Source Managers seht ihr verschiedene Reiter die für verschiedene Dateitypen stehen (Abb. 2.7). In dieser Vorlesung interresieren uns Vector, Raster und Delimited Text. Figure 2.7: Data source manager In Abbildung 2.7 sehen wir das Fenster für Vector. Hier muss nur unter Source über den Knopf die Datei ausgewählt werden. Für Raster sieht das Fenster praktisch genauso aus. Delimited Text steht für Tabellen im .csv (comma separated values) Format. Dort sieht die Eingabemaske etwas anders aus (Abb. 2.8). Figure 2.8: Delimited text im Data source manager Bei File Name wählt ihr über den Knopf die gewünschte .csv Datei (blau in 2.8). Im Normalfall solltet ihr bei File Format (orange in 2.8) nichts verändern müssen. Der Haken sollte hier bei CSV (comma separated values) sein. Falls ihr unter sample data (schwarz in 2.8) eine Tabelle seht wie in Abbildung 2.9 hat alles funktioniert. Figure 2.9: Tabelle im Delimited Text Menü des Data Source Managers Falls ihr keine Tabelle seht, wählt unter File Format die Option custom delimiters. QGIS wählt dann automatisch eine geeignete Option. Unter Geometry Definition müsst ihr im Idealfall nichts ändern. Wenn die Spalten der .csv Datei in denen die Koordinaten sind, informative Namen haben (z.B. Longitude und Latitude oder Easting und Northing oder X und Y), findet QGIS diese automatisch. Wenn dies nicht der Fall ist, müsst ihr X field und y filed selber auswählen. Zum Abschluss noch unten auf add gehen um die Datei hinzuzufügen. 2.4 Projekte Wenn ihr die Zusammenstellung der Dateien die ihr zu einem Zeitpunkt in QIGS geladen habt speichern wollt, könnt ihr Projekte dafür benutzen. Eine QGIS Projekt ist die Gesammtheit der gerade geladenen Layer. Ihr könnt es unter Project \\(\\rightarrow\\) Save speichern. Wenn ihr nun eine Projektdatei mit QGIS öffnet, öffnet ihr alle Layer die in dem Projekt gespeichert sind. Die gespeicherte Projektdatei enthält allerdings nicht die Dateien der einzelnen Layer. Sie enthält lediglich Verweise auf die Ordner in denen diese Dateien zu finden sind. Wenn ihr also ein Projekt speichert, danach die Dateien für die Layer des Projektes umbennent oder verschiebt, oder wenn ihr Ordner im Pfad der Dateien umbennent, kann das Projekt sie nicht mehr finden und gibt eine Fehlermeldung zurück. 2.5 Plug-ins Plugins sind kleine Erweiterungen, die QGIS zusätzliche Funktionalitäten verleihen. In dieser Vorlesung werden wir nur wenige benutzen, aber es ist dennoch gut zu wissen wo wir Plugins installieren und laden können. Das Pluginmenü öffnet ihr mit einem Klick auf den Plugins \\(\\rightarrow\\) Manage and install Plugins… (Abb 2.10). Figure 2.10: Öffnen des Pluginmenüs Das Pluginmenü (Abb. 2.11) enthält auf der linken Seite mehere Reiter. Figure 2.11: Das Pluginmenüs Unter All werden alle Plugins aufgeführt, unter Installed nur diejenigen die ihr installiert habt, unter Not Installed findet ihr alle Plugins die ihr nicht installiert habt und unter Upgradeable werden alle installierten Plugins aufgeführt, für die es ein Update gibt. Darunter könnt ihr noch nicht mehr funktionierende Plugins (invalid) sehen. Wir können Plugins einfach aus diesem Menü herraus installieren. Wenn ihr auf Not installed geht und aus der Liste, rechts neben den Reitern, ein Plugin auswählt könnt ihr unten rechts auf install Plugin klicken. Für diese Vorlesung werden wir das OpenLayers Plugin verwenden. Um das zu installieren müsst ihr zuerst im Reiter Settings einen Haken bei Show also experimental plugins setzen. Dann könnt ihr unter All oder Not Installed im Suchfenster OpenLayers Plugin eingeben und das Plugin installieren. Grundätzlich ist es auch möglich Plugins lokal aus .zip Dateien zu installieren (Install from ZIP). Das ist am ehesten relevant, wenn man selber Plugins programmiert und diese testen möchte. Daher werden wir diese Option in der Vorlesung nicht nutzen. "],["symbologie.html", "3 Symbologie 3.1 Punkte 3.2 Linien und Polygone", " 3 Symbologie Symbologie beschäftigt sich mit der Darstellung von Daten auf Karten. Die in diesem Abschnitt beschriebenen Methoden beziehen sich nur auf Vektordaten. Falls ihr die Darstellung von Rasterdaten ändern wollt, seht [hier][Darstellung]. 3.1 Punkte Wir beginnen dieses Kapitel mit der Symbologie von Punkten. Um die Darstellung eines Layers zu verändern wählen wir den Layer mit einem Rechtsklick im Layer Panel aus und wählen dann Properties…. Nun öffnet sich das Symbology-Menü (Abb. 3.1). Figure 3.1: Symbology-Menü Die Auswahl an Optionen in diesem Menü ist riesig. Wir werden uns hier auf die Grundlagen beschränken. Die meisten Funktionen, auch die die wir hier nicht besprechen, erklären sich von selbst oder werden klar wenn ihr ein wenig damit herumspielt. Ganz oben im Menü gibt es die Wahl zwischen verschiedenen Darstellungsarten (blau Abb. 3.1). Hier gibt es im Drop-Down Menü die Optionen: single symbol, categorized, graduated und rule-based. Es gibt auch noch weitere Optionen, aber die werden wir hier nicht behandeln. 3.1.1 Single Symbol Die Ansicht unter der Single Symbol Option seht ihr in Abbildung 3.1. Mit den Optionen in der orangen Box könnt ihr die Farbe der Punkte verändern (color), die Punkte durchsichtig machen (Opacity), die Größe der Punkte sowie die Maßeinheit der Größe verändern (Size) und die Punkte rotieren (Rotation). In der Box darunter (grün in Abb. 3.1) könnt ihr die Form des Symbols von einem einfachen Punkt zu anderen Symbolen verändern. 3.1.2 Categorized Bei Categorized sehen wir zu Anfang das Menü aus Abbildung (3.2). Figure 3.2: Symbology-Menü - categorized ohne Auswahl Bei dieser Darstellungsart ist die Idee, verschiedenen Kategorien verschiedene Farben zuzuordnen. Diese Kategorien sind durch Variablen aus der Attributtabelle definiert. In dem Libellendatensatz könnten wir als Beispiel die Variable titel_deut, also die deutschen Artnamen auswählen. Im Menü wählen wir die Variable unter Value (blau in Abb. 3.2). Nun haben wir eine Variable ausgewählt und können den einzelnen Werten dieser Variable Farben zuordnen. Die Darstellungsart categorized eignet sich am Besten für diskrete Variablen. Diskrete Variablen haben verschiedene Klassen (z.B. Haarfrabe, Landkreis, biologische Art, Höhenklasse). Ihnen gegenüber stehen kontinuierliche Variablen wie Größe, Länge, Anzahl oder Höhe. Für kontinuierliche Variablen ist die nächste Darstellungsoption (graduated) besser geeignet. Da wir in mit categorized verschiedene Kategorien auseinanderhalten wollen nutzen wir eine Farbskala mit zufällig zugeordneten Werten (color ramp = Random colors). Mit eine Klick auf classify (orange 3.2) ordnet QGIS jedem einzigartigen Wert der ausgewählten Variable eine Farbe zu. Das Ergebnis seht ihr in Abbildung 3.3. Figure 3.3: Symbology-Menü - categorized mit Auswahl Die Einstellung jetzt noch mit einem Klick auf ok bestätigen und die kategorisierte Darstellung ist fertig (Abb. 3.4). Figure 3.4: Categorized Darstellung der Libellen nach Artnamen 3.1.3 Graduated Die graduierte Darstellung eignet sich um Variablen mit Zahlenwerten auf einem kontinuierlichen Gradienten darzustellen. Anstat wie bei categorized jedem einzigartigem Wert eine Farbe zu zuordnen, benutzen wir einen von mehreren Algorithmen um die Daten in Gruppen einzuteilen und weisen jeder Gruppe eine Farbe zu. Die Anzahl der Gruppen können wir dabei frei wählen. Die anfänglich Ansicht der Darstellungsoption graduated seht ihr in Abbildug 3.5. Figure 3.5: Symbology-Menü - graduated ohne Auswahl In diesem Menü funktioniert eigentlich alles genauso wie in dem von categorized. Der einzige Unterschied ist das wir nun die Anzahl der Farbklassen auswählen (bei classes) und den Algorithmus mit dem die Grenzwerte der einzelenen Klassen festgelegt werden (mode, blau in Abb. 3.5). Die Algorithmen zur Auswahl sind Equal count (setze Grenzwerte so, dass in jeder Gruppe gleich viele Bobachtungen sind), Equal interval (setzte die Grenzen so, dass jeder Intervall gleichgroß ist), logarithmic (Grenzen sind entsprechen \\(10^x\\)), und weitere Algorithmen die kompliziertere Methoden anwenden. In der Praxis könnt ihr rumporbieren und den Algorithmus auswählen der euch am Besten gefällt. In Abbildung 3.6 seht ihr die Libellen, eingefäbt nach Höhe. Die Darstellung hat neun Klassen die mit Equal Count definiert sind. Figure 3.6: Graduated Darstellung der Libellen nach Höhe 3.1.4 Rule-based Bei der regelbasierten Darstellung definieren wir Regeln nach dennen die Symbole ausgewählt werden. Als Beispiel hier eine Karte bei der Punkte die unter 150 m Höhe liegen orange sind und solche die darüber liegen blau. Gleichzeitig sind Punkte mit mehr als 2 Individuen Rauten, während die restlichen Punkte Kreise sind (Abb. 3.7). Figure 3.7: Rule-based Darstellung der Libellen Wenn wir das Menü zu rule-based das erste Mal öffnen sieht es so aus (Abb. 3.8). Figure 3.8: Rule-based Darstellung ohne Auswahl Um eine neue Regel hinzuzufügen klicken wir auf das grüne Plussymbol unten links. Es öffnet sich das folgende Fenster (Abb. 3.9). Figure 3.9: Erstellen einer neuen Regel Bei Label können wir der Regel einen Namen geben. Bei Filter definieren wir unsere Regel. Diese Regeln folgen der gleichen Syntax wie alle Datenbankabfragen in QGIS. Darunter kann das Symbol für die gerade definierte Gruppe wie gewohnt angepasst werden. Um Beobachtungen mit einer Höhe kleiner 150m und weniger als 3 Individuen auszuwählen nutzen wir die folgende Regel: “anzahl” &lt; 3 AND “hoehe” &lt; 150. Die anderen drei Gruppen lassen sich daraus ableiten. 3.2 Linien und Polygone Die gleichen Prinzipen lassen sich 1:1 auf Linien und Vektorenobjekte übersetzten. Diese haben logischerweise etwas andere Standardformen zur Auswahl aber die grundlegenden Prinzipien bleiben gleich. "],["vektoroperationen.html", "4 Vektoroperationen 4.1 Die Datensätze 4.2 Die Attributtabelle 4.3 Vektoroperationen 4.4 Misc", " 4 Vektoroperationen In diesem Kapitel widmen wir uns der Arbeit mit Vektordaten. 4.1 Die Datensätze Wir wir Daten in QGIS laden können haben wir bereits hier besprochen. Für dieses Kaptiel laden wir anfangs drei Vektordatensätze in QGIS: Ein Punktdatensatz mit Beobachutungen von Kohlmeisen (parus_major.csv) Ein Polygondatensatz mit den Landkreisen Deutschlands (landkreise.gpkg) Ein Liniendatensatz mit dem Flussnetzwerk Deutschlands (flussnetzwerk_deutschland.gpkg) Die Datensätze findet ihr im Datenordner. Beim Laden der Maisendaten müsst ihr QGIS eventuell etwas nachhelfen. Bei mir wählt das Programm die Option Custom delimiter und Semicolon unter File Format. Um die Datei zu laden benötigt ihr allerdings Custom delimiter und Tab. Außerdem muss der Haken bei Space im gleichen Menü weg. 4.2 Die Attributtabelle Die Attbributtabelle können wir im Layer Panel öffnen über Rechtsklick \\(\\rightarrow\\) Open Attribute Table, in der Menüleiste oben über den Knopf oder über F6. Die geöffnete Tabelle der Kohlmeisendaten seht ihr in Abbildung 4.1. Figure 4.1: Attributtabelle der Kohlmeisendaten In der Kopfzeile sehen wir gleich einige Informationen: Features total: 354481, Filtered: 354481, Selected: 0. Die Attributtabelle hat also 354481 Reihen, sie enthählt 354481 Beobachtungen von Kohlemeisen. Wir habe noch keinen Filter angewandt, also enspricht die Anzahl der gefilterten Reihen der der gesammten Anzahl. Ebenso haben wir keine Reihen ausgewählt, also ist Selected aktuell 0. Indem wir auf die Zahl links der ersten Spalte klicken, wählen wir eine Reihe aus. Wenn ihr das macht seht ihr wie sich in der Kopfzeile die Zahl hinter Selected auf 1 erhöht. Mit gedrückter Umschalttaste (⇧) könnt ihr mehrere Reihen auswählen. Unten links (blau in 4.1) können wir die Tabelle filtern. Die Optionen sind: alle Reihen (standardmäßig gewählt), alle ausgewählten Reihen (Show selected features), alle Reihen deren Objekte im aktuellen Map View zu sehen sind (show features visible on map) oder alle Reihen die eine Bedingung erfüllen (Field filter und Advanced Filter (Expression)). Die letzte Option könnt ihr zum Beispiel nutzen indem ihr bei den Kohlmeisen bei Field Filter year auswählt und in die jetzt erscheinende Eingabeleiste 2014 eingebt. Nun werden nur Reihen angezeigt bei dennen die Spalte year 2014 ist. Nun entspricht die Zahl hinter Filtered nicht mehr der hinter Features total. 4.2.1 Zeilen auswählen Wir können Zeilen in der Attributtabelle auch über die Werkzeugleiste der Attributtabelle auswählen (blau in Abb. 4.2) Figure 4.2: Werkzeugleiste der Attributabelle Mit wählt ihr alle Reihen der Tabelle aus. Mit wählt ihr alle Reihen aus die aktuell nicht ausgewählt sind. Ihr dreht die akteulle Auswahl also um. Mit wählt ihr alle aktuell ausgewählten Zeilen ab ohne irgendwelche neu zu laden. Mit kommt ihr zu einer Auswahlmaske (Abb. 4.3) in der ihr Reihen nach ihren Attributen auswählen könnt. Figure 4.3: Ausswahl über Filter In der Maske hat jede Variable der Attributtabelle eine eigene Reihe. In die leeren Felder hinter den Attributnamen könnt ihr Werte eintragen nachdenen die Tabelle dann gefiltert wird. Geben wir bei year 2014 ein und bestätigen die Auswahl, in dem wir auf Select Features klicken (um den Kopf zu sehen müsst ihr vermutlich zuerst runterscollen), werden alle Zeilen ausgewählt, deren Eintrag der Spalt year 2014 ist. Mit verschiebt ihr alle ausgewählten Zeilen an den Anfang der Tabelle. Mit und schwenkt und zoomt ihr die Kartenansicht im Map View auf die ausgewählten Objekte. Ähnlich wie mit können wir auch mit Zeilen auswählen. Klick ihr auf erscheint folgendes Fenster (Abb. 4.4). Figure 4.4: Select by Expression Fenster Im linken Fenster geben wir Befehle ein anhand derer Reihen ausgewählt werden. Diese Befehle beinhalten immer mindestens eine Variable aus der Attributtabelle. Den Namen der Variable schreiben wir in Anführungszeichen. Wenn ihr euch nicht mit sicher seit wie eine Variable geschrieben wird oder wie genau der Name war könnt ihr im mittleren Fenster auf Fields and Values klicken. Dann öffnet sich darunter eine Liste mit allen Variablen der Attributtabelle. Wählen wir hier eine Variable mit einem einfachen Linksklick aus (year in Abb. 4.5) erscheinen im rechten Fenster die beiden Knöpfe All unique und 10 Samples. Mit All unique werden in dem Fenster unter den beiden neuen Knöpfen alle einzigariten Werte der ausgewählten Variable angezeigt. Mit 10 Samples werden zehn, zufällig gewählte Werte der ausgewählten Variable angezeigt. Mit einem Doppel-Linksklick auf den Variablennamen oder die Variablenwerte im rechten Fester tragen diese links im Befehlfenster ein. Figure 4.5: Fields and Values Eine paar Beispiele für Befehle sind: Befehl Effekt “year” = 2014 Alle Beobachtungen im Jahr 2014 “year” &gt;= 2014 AND “year” &lt;= 2017 Alle Beonachtungen der Jahre 2014,15,16 und 17 “locality” = ‘Goslar’ Locality ist Goslar “locality” LIKE ‘G%’ Locality fängt mit G an Im Folgenden arbeitet jeder mit seinem Heimatlandkreis. Mit den beschriebenen Schritten seit ihr in der Lage in dem Landkreisedatensatz die Zeilen auszuwählen die euren Heimatlandkreis beinhalten. Wenn ihr das gemacht habt könnt ihr zurück zum Layers Panel, dort den Lankreiselayer rechtsklicken und Export \\(\\rightarrow\\) Save Selected Features As… auswählen. Es öffnet sich ein neues Fenster. In diesem Fenster klickt ihr auf den Knopf um einen Ordner und Namen für die neue Datei zu wählen. Klick dann auf ok und eure Karte wird gespeichert und automatisch dem Layer Panel hinzugefügt. Aufgabe Wählt die Reihen in der Attributtabelle des Landkreislayers aus der eurem Heimatlandkreis entspricht. Speichert die gewählten Reihen in einer neuen Datei. 4.2.2 Der Field Calculator Neben diesen Tools gibt es noch weitere in der Werkzeugleiste (Zahlen in Abb. 4.2). Mit (1) könnt ihr die Reihenfolge der Spalten ändern und einstellen welche Spalten angezeigt werden. Mit dem Field Calculator (2) können wir neue Felder erstellen. Klicken wir auf öffnet sich das folgende Menü (Abb. 4.6). Figure 4.6: Der Field Calculator Das Fenster ähnelt dem von Select by Expression () stark. Wieder gibt es links das Befehlsfenster und rechts das Fenster und in der Mitte das Fenster mit Funktionen. Einige Beispiele für Ausdrücke und die dadurch erstellten Spalten findet ihr in der folgenden Tabelle. Ausdruck Effekt “year”*2 Eintrag der Spalte year multipliziert mit 2 “year” + “month” Eintrag der Spalte year plus Eintrag der Spalte month \\(length |Länge des Elements | |\\)area Fläche des Elements CASE WHEN “year” &gt;= 2018 THEN ‘new’ WHEN “year”&gt;= 2010 THEN ‘recent’ ELSE ‘old’ END Falls die Probe aus 2018 oder späteren Jahren ist ordne sue der Kategorie neu zu, trifft dies nicht zu aber sie ist aus dem Jahr 2010 oder später ordne sie der Kategorie recent zu. Falls beide Bedingungen nicht stimmen ordne sie der Kategorie old zu Achtet immer darauf, dass eure Spalte einen Namen hat (Output Field name) und das der Typ der Varialbe (Output field type) Sinn macht. Wenn ihr eine Zahl erwartet darf dort nicht boolean oder Text stehen. Beim letzten Beispiel in der Tabelle ist der Output ein Text (new, recent, old) also muss der Output filed type auf Text (string) eingestellt werden. Mit (3) können die Zeilen und Spalten der Tabelle eingefärbt werden. Klick ihr auf erscheint am rechten Rand des Fensters das folgende Menü (blau in Abb. 4.7). Figure 4.7: Konditionelle Formatierung Hier habt ihr die Wahl zwischen dem Field oder Full Row. Bei Field wählt ihr eine Spalte, erstellt eine Regel und diese eine Spalte wird der Regel folgend eingefärbt. Zum Beispiel können wir wieder die Spalte year wählen und dann auf New Rule klicken. Dann erscheint das folgende Fenster (Abb. 4.8). Figure 4.8: Konditionelle Formattierung 2 Unter Name geben wir den Namen der Regel an. Unter Condition die Regel. Das funktioniert genau wie Ausdrücke im Field Calculator oder bei Select by Expression. Unter Preset gibt es einige vorgefertigte Darstellungsmöglichkeiten. Darunter können mit Background und Text Hintergrund- und Textfarbe der Zellen eingestellt werden. Mit einem klick auf Done (unten links) bestätigen wir die Regel und die Zellen der gewählten Spalte werden eingefärbt. Wählen wir stattdessen Full Row müssen wir keine Spalte auswählen. Bei einem Klick auf New Rule erscheint das selbe Fenster, aber nun müssen wir bei Condition eine Variable spezifizieren. Wenn wir die Regel nun erstellen, werden alle Zellen der Reihe eingefärbt. Mit (4) docken wir die Attributtabelle an das QGIS Hauptfenster an. Damit haben wir alles aufeinmal im Blick. Außer bei sehr großen Bildschirmen sind aber die meisten Elemente nun zu klein um damit arbeiten zu können. 4.3 Vektoroperationen Alle hier beschriebenen Vektoroperationen findet ihr unter dem Reiter Vektor (Abb. 4.9). Figure 4.9: Hier findet ihr Vektoroperationen Das erste Feld bei den Vektoroperationen ist Geoprocessing. Hier sind die geläufigen und in der Vorlesung besprochenen Vektoroperationen beheimatet. Es folgt eine kurze Übersicht über die Funktionen. Mehr Details gibt es hier. 4.3.1 Clip Mit Clip können wir eine Teilmenge (Subset) eines Datensatzes erstellen. Das wird auch spatial subsetting oder spatial filtering genannt. Die Daten aus dem Input Layer werden auf diejenigen Beobachtungen reduziert, die innerhalb des Overlay Layers liegen. Dabei müsst ihr darauf achten, dass die beiden Datensätze im gleichen Koordinatenbezugssystem vorliegen. Der neue Datensatz heißt in den Defaulteinstellungen clipped und wird dirkt in das Layer Panel geladen. Aufgabe Erstellt mit dem clip Werkzeug Datensätze für Kohlmeisen sowie Gewässer die in eurem Heimatlandkreis liegen. 4.3.2 Buffer Mit dieser Funktion könnt ihr einen Puffer um Vektorobjekte legen. Im obersten Feld (blau Abb. 4.10) wählt ihr den Layer den ihr puffern wollt. Wie ihr seht gibt es hier auch den Knopf. Ihr könnt also auch neue Daten laden und dirket puffern. Falls eure Daten in eine geographischen Koordinatenbezugssystem sind, also in Längen- und Breitengraden vorliegen (z.B. WGS84 mit EPSG:4326) bekommt ihr eine Warunung (grün Abb. 4.10). In der Regel sind Pufferdistanzen leichter in Metern anzugeben als in Längen- bzw. Breitengraden. Je weiter wir vom Äquator entfernt sind, desto größer wird zusätzlich der Unterschied zwischen einem Grad Länge und einem Grad Breite. Am Besten transformiert ihr eure Daten also in ein projeziertes Koordinatenbezugssystem, das in Metern misst, wie z.B. UTM 32N (EPSG: 25832). Wie das geht seht ihr hier. Figure 4.10: Die Puffer-Funtion Mit den reprojezierten Daten bekommen wir keine Warnung mehr. In Abbilding 4.11 seht ihr einen zehn Meter Buffer rund um die Flüsse meines Heimatlandkreises. Aufgabe Zieht Puffern der Größen 10, 100 und 500 Metern um die Flüsse eures Landkreises. Wie weit muss der Puffer sein, damit eine Kohlmeise darin beobachtet wurde? Figure 4.11: 10 Puffer rund um die Landkreise 4.3.3 Convex hull Eine Convex Hull ist eine Hülle, die um jedes Elemente des Input Layers gezogen wird. Es ist nicht die Hülle die man um eine Gruppe von Punkten legen würde. Daher funktioniert dies Funktion eigentlich nur bei Linien oder Polygonen. In Abbildung 4.12 seht ihr die Flüsse in meinem Landkreis, eingefärbt nach ihrer OBJECTID (sieht hier). Figure 4.12: Flüsse im Landkreis nach OBJECTID eingefärbt Jede dieser Linien besteht aus mehreren Punkten die in einer bestimmten Reihenfolge miteinander verbunden sind. Mit der Convex Hull Funktion ziehen wir nun eine Hülle um all Punkte einer Linie und das für jede Linie (Abb. 4.13). Figure 4.13: Convex Hull um Flüsse Um eine Convex Hull um alle Elemente eines Layers zu ziehen siehe die Minimum bounding geometry Funktion. 4.3.4 Difference Difference ist das Gegenteil von Clip. Bei dieser Funktion werden alle Elemente behalten, die außerhalb des Overlay Layers liegen. 4.3.5 Dissolve Mit Dissolve kann die Anzahl an Features in einem Layer reduziert werden, indem alle Felder mit gleichem dissolve field kombiniert werden. Als Beispiel können wir den ursprünglichen GADM Layer nehmen. Abbildung 4.14 zeigt links den original Layer und rechts den Layer nachem Dissolve mit x als dissolve feature angewandt. wurde. All die Bezirke mit dem Gleichen Landkreis (NAME2) sind nun ein Feature. Figure 4.14: Dissolve von GADM Deutschland anhand der Varable NAME2 Aufgabe Löst die Grenzen der einzelnen Bereiche in eurem Landkreis auf. 4.3.6 Intersection Bei der Verschneidung oder Intersection ist das Ziel, die Attribute eines Objektes mit denen eines anderen zu Kombinieren. Nehmen wir zum Beispiel den GADM Layer von Deutschland. Zustäzlich zu den Informationen die wir bereites zu jeden Feature haben, wollen wir nun wissen in welche Ökoregionen (nach Illies, Daten hier) die Landkreise Fallen. Abbildung 4.15 zeigt beide Layer. Klar ist zu sehen, dass verschiedene Ökoregionen in Deutschland vorkommen. Ihr seht auch, dass ich immernoch den dissolved GADM Layer aus dem vorherigen Abschnitt benutze. Figure 4.15: Dissolve von GADM Deutschland anhand der Varable NAME2 In der nächsten Abbilung sehen wir das Ergebnis von einer Verschneidung mit den Ökoregionen als Input Layer und den GADM Layer als Overlay Layer. Die einzelnen Features sind nach der Ökoregion eingefäbt. Wie wir sehen, erhalten wir den Umriss des GADM Layers also des Overlay Layers. Die einzelen Features sind fast alle wieder die ursprünglichen Bezirke vor dem Dissolve. Dort wo einzelne Bezirke mehrere Ökoregionen enthalten, bzw. die Grenze zwischen zwei Regionen durch einen Bezirk verläuft, wurde der Bezirk an dieser Grenze in zwei Feature getrennt. Jedes Feature enthält nun sowol die Informationen aus dem GADM als auch aus dem Ökoregionen Layer. Figure 4.16: Ergebnis der Verschneidung von Ökoregionen und GADM 4.3.7 Union Mit Union kombinieren wir Elemente. Das können Elemente eines Layers sein oder aus verschiedenen. Wenn wir die Elemente eines Layers kombinieren wollen geben wir diesen Layer als Input Layer an und lassen Overlay Layer leer. In Abbildung 4.17 seht ihr ein Beispiel dafür. Hier sind drei Polygone, jedes überlappt mit jedem anderen und in der Mitte überlappen alle drei. Figure 4.17: Beispielpolygone bevor Union angewandt wurde Die zugehörige Attributtabelle hat drei Spalten ID, Zahl und Text. Alle drei geben die Nummer des Polygons wieder (Abb. 4.18). Figure 4.18: Attributtabelle der Beispielpolygone bevor Union angewandt wurde Wenden wir Union auf diesen Layer an erhalten wir die Layer aus Abbildung 4.19. Figure 4.19: Beispielpolygone nachdem Union angewandt wurde Die zugehörige Attributtabelle ist in Abbildung 4.20 ist zu sehen. Figure 4.20: Attributtabelle der Beispielpolygone nachdem Union angewandt wurde Nun gibt es für jede überlappende Fläche eigene Polygone. Für eine Fläche auf der Polygon eins und zwei überlappen gibt es nun ein Polygon für Polygon eins und eins für zwei. In der Mitte, wo alle drei überlappen, gibt es nach Union drei Polygone – eines für jeden Original Layer. Am deutlichsten ist das zu sehen, wenn wir nur die Elemente mit einer ID anzeigen lassen (Abbildung 4.21). Hier sehen wir, dass die Form des ursprünglichen Rechtecks erhalten bleibt, wir nun allerdings vier anstelle von einem Polygon haben: einen für die Fläche die nicht überlappt (unten rechts), einen für die Fläche die mit dem linken Polygon überlappt (unten links), einen für die Fläche die mit dem oberen Polygon überlappt (oben rechts) und einen für die Fläche die mit beiden anderen Flächen überlappt (oben links). Die beiden anderen Polygon wurden genauso aufgeteilt. Figure 4.21: Eines der ursprünglichen Polygone nach Union Wie bereits erwähnt können wir Union auch mit zwei verschiedenen Layer nutzen. Dafür habe ich einen zweiten Beispiellayer erstellt (Abb. 4.22). Figure 4.22: Beide Beispiellayer Diesen wähle ich nun als Overlay Layer im Union Fenster. Der Ergebnis beinhaltet alle vier ursprünglichen Polygone sowie die Flächen in dennen Polygone aus dem ersten und zweiten Layer überlappen als eigene Polygone (Abb. 4.23). Figure 4.23: Ergebniss von Union mit zwei Layern Flächen in denen Polygone aus dem ersten Layer überlappen sind diesmal keine eigenen Flächen. Ein Blick in die Attributtabelle zeigt, dass alle Elemente des neuen Layers alle Attribute beider ursprünglichen Layer haben (Abb. 4.24. Figure 4.24: Attributtabelle nach Union mit zwei Layern 4.4 Misc 4.4.1 Minimum bounding geometry Mit Minimum bounding geometry können wir verschiedene Polygone um die Elemente eines Layers ziehen. Die Funktion findet ihr in der Processing Toolbox. Bei Input Layer wählt ihr den Layer um dessen Elemente ihr das Polygon ziehen wollt. Welches Polygon ihr berechnen wollt wählt ihr mit dem Geometry type Argument. Envelope (Bounding box) ist das kleinste Rechteck, das alle Elemente enthält, wobei die Seiten parallel zu Meridianen und Parallelen sind. Bei Minimum Orientet Rectangle erhalten wir ein das kleinste Rechteck das nicht parallel zu Meridianen und Parallelen sein muss, Minimum Encolsing Circle ist der kleinste Kreis, und Convex Hull ist die Convex Hull. "],["koordinatenbezugssysteme.html", "5 Koordinatenbezugssysteme 5.1 Welches Koordinatenbezugssystem haben meine Daten? 5.2 Wie ändere ich das Koordinatenbezugssystem meiner Daten? 5.3 Wie finde ich das Koordinatenbezugssystem herraus?", " 5 Koordinatenbezugssysteme 5.1 Welches Koordinatenbezugssystem haben meine Daten? Klickt mit der rechten Maustaste auf den Layer von dem ihr das aktuelle Koordinatenbezugssystem (KBS) wissen wollt und wählt dann Properties, die unterste Option. Klick hier ganz oben auf Information . Im dritten Feld von oben (Coordinate Reference System (CRS)) findet ihr die Informationen. Aufgabe Welches KBS haben die Kohlmeisendaten? 5.2 Wie ändere ich das Koordinatenbezugssystem meiner Daten? Hier gibt es zwei Szenarien: 1. Ihr habt eure Daten im falschen KBS geladen und wollt dies nun ändern. 2. Die Daten liegen im richtigen KBS vor, aber ihr möchtet es ändern. Im ersten Szenario wollt ihr also die Koordinaten an sich nich verändern. Ihr wollt nur ändern wie QGIS diese Koordinaten der Erde zuweist. Im zweiten Szenario wollt ihr die Koordinanten an sich ändern. Für das ersten Szenario, geht im Fenster Properties das wir bereits im letzten Teilabschnitt geöffnet haben in den Reiter Source (Abbilding 5.1). Figure 5.1: Source Fenters Im obersten Fenster wählt ihr den Layer den ihr anpassen wollt. Darunter könnt auf die aktuelle Auswahl klicken um eine Liste mit kürzlich verwendeten oder geläufigen Alternativen angezeigt zu bekommen. Falls das gesuchte KBS nicht dabei ist könnt ihr mit einem Klick auf den Knopf ein Fenster öffnen in dem ihr mithilfe des EPSG Codes jedes KBS finden könnt, das QGIS kennt. Für das zweite Szenario nutzen wir das reproject layer Tool (Abb. 5.2). Figure 5.2: Reproject Layer Im erscheinenden Fenster einfach den Layer auswählen den ihr reprojezieren wollt (Input Layer), unter Target CRS das Ziel KBS auswählen und auf Run klicken. 5.3 Wie finde ich das Koordinatenbezugssystem herraus? Folgendes Szenario: Ihr habt einen Datensatz erhalten mit räumlichen Koordinaten und Namen der Orte. Ihr wisst aber nicht in welchem KBS und in welcher Projektion die Daten vorliegen. Dabei kann euch die Website http://projfinder.com/ weiterhelfen. Die Seite ist zweigeteilt (Abb. 5.3). Figure 5.3: projfinder.com Auf der linken Seite seht ihr zwei Eingabefelder und auf der rechten eine Karte mit Fadenkreuz. Angenommen ihr wisst nicht welche Projektion die Kohlmeisendaten haben, aber durchdie Spalte locality haben weitere Informationen zur Probestelle. Einen Ausschnit meiner Tabelle seht ihr in Abbildung 5.4. Figure 5.4: Kohlmeisendaten In Reihe elf sehe ich das eine Beobachtung aus Bad Harzburg stammt und die Koordinaten 51.87653 und 10.556916 hat. Nun kann ich auf projfinder.com auf der rechten Karte Bad Harzburg auswählen, links die beiden Koordinanten eingeben und dann find auf find my projection klicken. Dann tauch unter dem find my projection Knopf eine Tabelle auf (Abb. 5.5). Figure 5.5: Auswahl der besten Projektionen In der Tabelle sind verschiedene Projektionen aufgeführt und die Distanz die der Punkt mit den angegeben Koordinatne in der jeweiligen Projektion zu dem von uns mit dem Fadenkreuz gewähten Punkt hat. In unserem Fall wissen wir das die Daten in dem geographischen KBS WGS 84 vorliegen. Das ist erst an Stelle neun, aber die Unterschiede zwischen den zehn aufgeführten KBS bzw. Projektionen bewegen sich im Zentimeterbereich. Falls eure Daten nur eine kleine Fläche bedecken, so wie unsere Maisendaten, ist es egal welche der hier angegebenen Projektionen ihr wählt. Alle passen für diese Region gut. Falls ihr einen größeren Datensatz habt (ganz Deutschland oder Europa) solltet ihr das Verfahren mit mehreren Punkten wiederholen und die Projekten mit der insgesammt kleinsten Abweichung wählen. Die dafür gewählten Punkte sollten möglichst weit von einander entfernt liegen. In diesem Beispiel könnt ihr die Ortbeschreibungen vermutlich gut finden, da es eure eigenen Landkreise sind. Falls ihr mit Ortsnamen in den Daten nichts anfangen könnt, hilft Google Maps. Aufgabe Ladet die Datensätze astast_test_01.csv und astast_test_02.csv aus dem Datenordner Nutzt projfinder.com um herauszufinden in welchen Projektionen diese beiden Datensätze vorliegen. "],["digitalisierung.html", "6 Digitalisierung 6.1 Keycoding 6.2 Erstellen eines neuen Vektorlayers", " 6 Digitalisierung 6.1 Keycoding In diesem Abschnitt werden wir einem existierenden Vektorlayer eine neue Spalte hinzufügen. Das könnte in der Praxis der Fall sein, wenn ihr neue Daten zu bereits digitalisierten Objekten erhalten oder erhoben habt und dies nun nachtragen wollt. Bitte ladet für diese Beispiel den Polygon Vektorlayer mit eurem Heimatlandkreis den ihr in 4.2.1 erstellt habt. Falls dieser noch geladen ist, müsst ihr ihn nicht neu laden. Geht nun in die Attributtabelle, entweder über Rechtsklick im Layer Panel oder über F6, wenn der Layer im Layer Panel ausgewählt ist. Dort müssen wir als erstes den Bearbeitungsmodus öffnen. Das könnt ihr indem ihr oben links auf den Stift klickt oder mit Strg+E. Nun sind einige der vorher grauen Symbole in der oberen Leiste farbig geworden. Darunter auch das Symbol New Field (Abb. 6.1). Figure 6.1: Bearbeitungsmodus in der Attributtabelle Wenn ihr darauf klickt erscheint das folgende Fenster (Abb. 6.2): Figure 6.2: Hinzufügen einer neuen Spalte Im ersten Feld gebt ihr den Namen der neuen Spalte ein, am Besten ohne Leerzeichen und Umlaute. Das mittlere Feld kann leer gelassen werden. Im unteren Feld wählt ihr den Typ der Variable aus. Die Optionen sind ganze Zahlen (Integer) mit 32 oder 64 bit, Kommazahlen (decimal number (real)), Text (string), Datum und Boolean. 64 bit Integer braucht ihr nur für Zahlen &gt; 2147483647. Boolean sind logische Werte also entweder TRUE oder FALSE. Für unser Beispiel wählen wir Integer 32 bit und kilcken dann ok. Nun sollte die neue Spalte in der Tabelle sein. Ihr könnt in die leeren Zellen der neuen Spalte klicken um dort Werte einzutragen. 6.2 Erstellen eines neuen Vektorlayers Wir können Daten aus Hintergrundkarten digitalisieren, indem wir diese quasi abpauschen. Dafür laden wir als erstes die openstreetmap Hintergrundkarte (Abb. 6.3). Figure 6.3: OpenStreetMap Hintergrundkarte Falls ihr das OpenLayers Plugin noch nicht installiert habt, tut dies bitte jetzt (Plug-ins installieren). Nun könnt ihr in eurem Landkreis einige Häuser ausschen die ihr digitalisieren wollt. Zoomt zu diesem Haus und klickt dann auf Layer \\(\\rightarrow\\) Create Layer \\(\\rightarrow\\) New Shapefile Layer. Dann sollte das folgende Fenster erscheinen (Abb. 6.4). Figure 6.4: Fenster um neue Vektorlayer zu erstellen Hier könnt ihr den neuen Layer als Datei speichern (blau), einen Geometrietyp wählen (Punkt, Linie oder Polygon; orange) und eine Attributtabelle anlege (gelb). Wir werden einen Polygonlayer erstellen und eine Variable mit dem Namen Name in der Attributtabelle anlegen. Wenn ihr auf Ok klickt erscheint der neue Layer im Layerpanel. Aber er hat noch keine Geometrien. Um die zu erstellen aktivieren wir den Editing Mode (Abb. 6.5). Figure 6.5: Editing Mode Zwei Knöpfe weiter rechts ist nun der Knopf AddPolygon Feature farbig geworden. Wenn ihr diesen Knopf auswählt erscheint ein Fadenkreuz. Mit jeden Kilck der linken Maustaste setzt ihr einen neuen Eckpunkt für euer Polygon. Die Verbindung zwischen dem ersten Punkt und dem zuletzt neu erstellten Punkt wird automatisch gezogen. Die Linien dürfen sich nicht überlappen. Solche Kreuzungen werden mit grünen Kreuzen markiert (Abb. 6.6). Wenn ihr fertig mit einem Polygon seit klickt auf die rechte Maustaste. Nun erscheint ein Fenster in dem ihr Werte für die vorher angelegten Variablen eingeben könnt. Die Variable fid (feature ID) gibt es immer und wir können den Eintrag autogenerate stehen lassen. Klick nun auf ok und ein neuer Polygon sollte erscheinen. Falls dies nicht der Fall ist guckt ob der OpenStreetMapLayer vielleicht darüber liegt. Figure 6.6: Erstellen von eigenen Polygonen Aufgabe Digitaliersiert fünf Häuser in euren Landkreis. Mit diesen neu erstellten Polygonen können wir eine Reihe von Operationen ausführen. Um diese Tools nutzen zu können müsst ihr unter View \\(\\rightarrow\\) Toolbars \\(\\rightarrow\\) die Advanced Digitizing Toolbar aktivieren. Wir können mit dem Vertex Tool (Abbildung 6.7 orange Box) die Eckpunkte verschieben oder neue Eckpunkte zwischen zwei bestehende Punkte setzten. Wir können sie verschieben (Abb. 6.7 - 1), drehen (2), vergrößern und verkleinern (3), vereinfachen (4), ein Loch einfügen (5), puffern (auch negativ, 6) oder Grenzen ziehen und das eine Polygon damit in mehrere Formen und folglich auch mehrere Einträge in der Attributtabelle umwandeln. Figure 6.7: Verändern von Polygonen "],["rasteroperationen.html", "7 Rasteroperationen 7.1 Einführung 7.2 Darstellung von Rastern 7.3 Rasteralgebra 7.4 Terrain Analysis 7.5 NDVI berechnen", " 7 Rasteroperationen 7.1 Einführung Als erstes Beispiel nutzen wir hier ein digitales Höhenmodell (digital elevation model, DEM) für Deutschland. Die Datei DEM_deutschland.tif findet ihr in Datenordner. Wir laden die Datei über den Data Source Manage (Strg + L). Im Data Source Manager wählt ihr links den Reiter Raster und bei Raster dataset(s) könnt ihr mit einem Klick auf die gewünschte Datei auf dem Computer auswählen. Der Raster erscheint nun in schwarz-weiß (Abb. 7.1). Figure 7.1: DEM für Deutschland nach dem Laden Helle Regionen sind höher und dunklere tiefer. Links im Layer Panel wird euch die Farbskala mit Minimal- und Maximalwert angezeigt. Wie bei einem Vektor Layer können wir mit Rechtsklick auf den Layer über Properties die meisten wichtigen Informatonen abrufen und einge Eigenschaften anpassen. Oben im Properties Fenster seht ihr den Information (; Abb. 7.2) Reiter . Figure 7.2: Information Reiter in Properties Fenster Unter der Überschift General sehen wir Informationen zum Namen (Name), dem Dateipfad (Path), der Dateigröße (Size), dem Datum an dem die Datei das letzt mal verändert wurde (Last modified) sowie der Software die genutzt wurde um die Datei in QGIS zu laden (Provider). Danach kommen nähere Informationen zu den Eigenschaften des Rasters. Das Ausmaß (Extent) also die jeweils größten und kleinsten X- und Y-Koordinaten. Width und Height geben die Anzahl der Spalten und Reihen des Rasters an. Der Data type beschreibt die Art der Variable die in den einzelnen Zellen gespeichert ist. In diesem Fall Float32 also eine Kommazahl (floating point number) bei der für jede Zahl 32 bit (binary digits) freigehalten werden. Mit 64 bit könnte man mehr verschiedene Zahlen darstellen (\\(2^{64}\\) anstelle von \\(2^{32}\\)) aber die Datei wäre größer. Der GDAL Driver gibt an welchen Treiber GDAL (der Provider) benutzt hat um die Datei zu laden. Unter Band1 sehen wir zusammenfassende Informationen zum ersten Band (und in diesem Fall einzigen Band). Was ist der maximale Wert, der minimale, der Mittelwert und die Standardabweichung. 7.2 Darstellung von Rastern Unter Symbology (, Abb. 7.3) können wir die Darstellung anpassen. Figure 7.3: Raster Symbologie Die wichtigste Einstellung hier ist gleich die oberste: Render type. In dem drop-down Menü gibt es die Auswahlmöglichkeiten: Multiband Color, Paletted/ Unique Values, Singleband grey, Singleband pseudocolor, Hillshade und Contours. Standardmäßig ist hier Singleband grey eingestellt. Die Render type Einstellung bestimmt was für Optionen und Fenster im restlichen Menü zu sehen sind. Bei Singleband grey können wir unter Color gradient den Gradienten umdrehen (hohe Werte dunkel tiefe Werte hell). Darunter werden der Maximal- und Minimalwert angezeigt und bei contrast enhancement können wir mithilfe dieser Zahlenspanne die Darstellung anpassen. Mit der Einstellung no enhancement habe alle Zellen die gleiche Farbe. Mit Strech to MinMax wird der schwarz-weiß Gradient an die angegebene Minimal- und Maximalwerte angepasst. Diese Werte müssen nicht den tasächlichen Werten des Rasters entsprechen. Ihr könnt auch nur einen Teil davon für den Gradienten nutzen. Alle Werte die über dem Maximum liegen bzw. alle Werte die unter dem Minimum liegen bekommen die gleiche Farbe wie das Maximum bzw. Minimum. Mit Stretch and Clip to MinMax werden Zellen mit Werten außerhalb des angegebenen Zahlenraums entfernt. Bei unserem DEM können wir so die negativen Werte entfernen. Clip to MinMax entfernt Zellen mit Werten außerhalb des angegebenen Zahlenraumes ohne die restlichen Zellen einzufärben. Bei Singleband pseudocolor können wir eine anderen Farbgradienten wählen als schwarz-weiß. Den Farbgradienten wählt ihr mit dem kleinen Pfeil rechts des Gradienten bei color ramp. Im Fenster darunter seht ihr die Farben, die den jeweiligen Zahlenbereichen zugeordnet sind. Unter dem Fenster könnt ihr bei Mode ändern wie die Farben den Zahlenbereichen zugeordnet werden. Mit Equal Interval wählen wir, dass die Gruppen zwischen Minimalwert und Maximalwert alle die gleiche Menge an Höhenmetern abdecken. Mit Classes können wir die Anzahl an Gruppen anpassen. Die Einstellung Paletted/ Unique Values ist für Raster geeignet die kategorische Variablen darstellen wie z.B. Landnutzungstyp (LULC Daten). Hier bekommt jeder Werte eine eingene Farbe und die Farben liegen nicht auf einem gemeinsamen Farbgradienten. Die Farben sollten möglichst unterschiedlich sein, damit die Kategorien klar voneinenander unterscheidbar sind. Als Beispiel zeige ich hier die CORINE Land Cover Daten (hier verfügbar). In Abbildung 7.4 ist die schwarz-weiß Darstellung und das Symbologiefenster von Paletted/ Unique Values. Figure 7.4: CORINE Landcover Daten in schwarz-weiß Wenn wir dort auf classify klicken wird jedem Wert des Rasters eine Farbe zugeordnet. Nachdem wir auf Apply klicken wird dies im Map View auch dargestellt. Abbildung 7.5 zeigt einen Ausschnitt der so erstellten Karte. Figure 7.5: CORINE Landcover Daten mit Paletted Values Die Einstellung Multiband Color ist für Raster mit mehreren Bändern geeignet. Das sind vor allem Satellitenfotos. Ein Beispiel für so eine Datei ist orthophoto.tif im Dateiordner. Ihr könnt die Datei wie jeden anderen Raster auf in QGIS laden. In QGIS werden die drei Bänder der Datei im Layer Panel angezeigt. Jedes Band enthält die Intensität von einer Farbe: Band 1 rot, Band 2 grün und Band 3 blau. Jedes Band reicht von 0 bis 255, hat also 256 Werte, was sich mit einem 8bit Integer (\\(2^8 = 256\\)) speichern lässt. Auf diese Art und Weise lassen sich Farben mit ihrem RGB (rot, grün, blau) Wert speichern. Die Extremata sind schwarz (0,0,0) und weiß (255,255,255). Für diesen Raster mit drei Bändern hat QGIS automatisch den Render type Multiband Color gewählt. Die letzten beiden Typen Hillshade und Contours werden eher selten genutzt. Erstere täuschen einen 3D Effekt vor und letztere erstellen eine Karte mit Isolinien (beim DEM Isohypsen). Hillshades werden wir im Kapitel Terrain Analysis näher betrachten. 7.3 Rasteralgebra Rasteralgebra ist in QGIS im Raster calculator verfügbar (Abb. 7.6). Figure 7.6: Knopf um den Raster calculator zu öffnen Öffnen wir den Raster calculator, öffnet sich folgendes Fenster (Abb. 7.7). Figure 7.7: Der Raster calculator Alle aktuell geladenen Raster werden im Fenster Raster bands (blau Abb. 7.7) aufgeführt. Befehle für Funktionen (unter Operators) werden im Fenster Raster calculator expression eingegeben (grün Abb. 7.7). Ausdehnung und Reihen- sowie Spaltenzahl können unter Spatial Extent (gelb Abb. 7.7) angepasst werden. Unter Result Layer (orange Abb. 7.7) könnt ihr einstellen ob der resultierende Layer gespeichert werden soll oder nach schließen der aktuellen QGIS Sitzung gelöscht werden soll (Option Create on-the-fly raster …). Bevor ihr die Funktion mit einem Klick auf OK ausführen könnt müsst ihr entweder einen Namen für die zu speichernde Datei auswählen oder die create-on-the-fly Option markiert haben. 7.3.1 Lokale Funktionen Mathematische Funktionen Mathematische Funktionen können einfach wie bei einem Taschenrechner eingegeben werden. Wenn wir den DEM von Deutschland um 40 Meter erhöhen wollen können wir folgenden Befehl ausführen (Abb. 7.8). Mit anderen mathematischen Funktionen (-, *, /, exp) funktiert das genauso. Figure 7.8: Raster calculator: + Logische Funktionen Um logische Funktionen zu demonstrieren erstellen wir eine Version des DEM in dem nur Zellen mit über 400 Meter Höhe üNN enthalten sind. Figure 7.9: Befehl für Zellen mit Werten größer 400 Das Ergebniss ist ein Raster mit drei verschiedenen Zellwerten: 0 (&lt;=400), 1(&gt;400) und eine sehr große negative Zahl für fehlende Werte (außerhalb von Deutschland). Da wir nun eine kategorische Variable haben ist der Darstellungsstyl Paletted passend (Abb. 7.10). Figure 7.10: Raster mit zwei Höhenklassen Wenn wir nun diesen Layer mit dem Originallayer multiplizieren würde wir einen Layer erhalten, in dem alle Zellen mit einer Höhe von über 400m ihren ursprünglichen Höhenwert haben und alle anderen 0. Reclassification Einfacher geht das allerdings mit dem Reclassification by table Tool, das ihr über die Processing Toolbox öffnen könnt (Abb. 7.11). Figure 7.11: Reclassification by table Unter Reclassification Table könnt ihr mit einem Klick auf eine Tabelle erstellen um eine kontinuierliche Variable (z.B. Höhe) in Klassen einzuteilen. Meine Beispieltabelle seht ihr in Abbildung 7.12. Figure 7.12: Reclassification table Ihr müsst auf OK klicken, damit die Tabelle auch gespeichert wird. Wenn ihr jetzt auf Run klickt wird der neue Raster berechnet. Da es im Fall des DEMs für Deutschland Werte &lt; 0 als kleiner als die untere Grenze der untersten Klasse gibt haben wir mehr als die vier Klassen erhalten (Abb. 7.13). Figure 7.13: Einzelwerte angezeigt bei Paletted Alle Werte die nicht von uns bestimmten Klassen entsprechen können wir löschen indem wir sie auswählen und auf die rote Minus Taste rechts von classify drücken. Für eine bessere Darstellug klicken wir außerdem auf die Farbleiste und wählen im nun erscheinenden Fenster oben rechts Discrete anstelle von Continuous. Die so erzeugte Karte seht ihr in Abbildug 7.14. Figure 7.14: Deutschland in vier Höhenklassen 7.3.2 Fokale Funktionen Um fokale Funktionen außerhalb der Terrainanalyse zu berechnen muss QGIS auf GRASS GIS zurückgreifen. Ihr solltet GRASS GIS in der Processing Toolbox sehen (Abb. 7.15). Figure 7.15: Deutschland in vier Höhenklassen Falls ihr GRASS GIS dort nicht seht kontrolliert ob die beiden GRASS Plugins (GRASS 7 und GRASS GIS provider) aktiviert sind. Sucht in der Processing Toolbox nach r.neighbors. In dieser Funktion könnt ihr unter Input Raster Layer den Input Layer wählen, unter Neighborhood operation was für eine Statistik berechnet werden soll und unter Neighborhood Size die Größe des moving window. 7.3.3 Zonale Funktionen Zonale Statistken können wir in QGIS dem Zonal statistic Tool berechnen. Als Beispiel berechnen wir hier den Mittelwert des DEM für jeden Bezirk in meinem Landkreis. In Abbildung 7.16 seht ihr das Fenster der Zonal statistic Funktion. Figure 7.16: Zonal statistic Tool Bei Input wählen wir den Layer mit den Zonen, für die wir die Werte berechnen wollen. Bei Raster Layer den Raster von dem wir die Werte berechnen wollen. Die berechneten Werte werden der Attirbuttabelle des Inputlayers als Spalten hinzugefügt. Bei Output column prefix könnt ihr einen Präfix für die Spaltennamen wählen. Ich wähle hier den Präfix hoehe_. Unter Statistics to calculate könnt ihr die gewünschten Statistiken auswählen. Standardt ist count, sum und mean. Da wir hier nur am Mittelwert interressiert sind wähle ich nur mean. Abbildung 7.17 zeigt die nach mittlerer Höhe eingefärbten Bezirke. Figure 7.17: Bezirke im Kreis Goslar mit mittlerer Höhe 7.4 Terrain Analysis Die Funktionen der Terrain Analyse findet ihr unter Raster \\(\\rightarrow\\) Analysis. 7.4.1 Gefälle &amp; Aspekt Die meisten in der Vorlesung besprochenen Funktionen finden sich in dem Analysis Menü mit selbsterklärenden Namen. Mit Slope berechnen wir das Gefälle unseres DEMs und mit Aspect die Richtung des stärksten Gefälles. 7.4.2 Gewässernetzwerk Hierfür nutzen wir Funktion aus SAGA GIS. Auch hier gilt, falls ihr SAGA GIS nicht in eurer Processing Toolbox seht, üperprüft ob das entsprechende Plugin aktiviert ist. Als erstes füllen wir die Lücken in unserem DEM mit der Funktion Fill Sinks (Wang &amp; Liu). In der Funktion müssen wir nur unser DEM angeben, die anderen Argumente können unverändert bleiben. Die Funktion erstellt drei Outputs: Flow Directions, Watershed Basins und Filled DEM. Den Filled DEM Layer nutzen wir nun als Input für die Funktion Strahler Order. Wieder müssen wir aus dem Input Layer keine Argumente ändern oder eingeben. Das Ergebnis seht ihr auf Abbildug 7.18. Figure 7.18: Gewässernetzerk für Deutschland - ohne Grenzwert Um das Netzwerk übersichtlicher zu machen entfernen wir kleinere Gewässer (Stahler Ordnung &lt; 2) mit dem Raster calculator und färben die übriggelbiebenen Gewässer als singleband pseudocolor blau ein (Abb. 7.19). Figure 7.19: Gewässernetzerk für Deutschland 7.5 NDVI berechnen Mithilfe des Raster Calculators und der benötigten Daten können wir den NDVI in QGIS berechnen. Die notwendingen Satellitendaten könnt ihr entweder aus Datenordner oder selber aus dem EarthExplorer laden. In der ersten Option ist nur das Bild für Landau verfügbar. Um das Bild für euren Kreis runterzuladen müsst ihr einen (kostenlosen) Account bei EarthExplorer anlegen. Eine ausführlche Anleitung zum Downloaden von Sattelitenbildern aus dem EarthExplorer gibt es hier. Hier bekommt ihr einen Überblick über die Bänder von Landsat 8. Das Near Infrared Band ist Band 5 und das Rot Band ist Band 4. Der NDVI \\[\\dfrac{NIR - RED}{NIR + RED}\\] ist daher \\[\\dfrac{Band5 - Band4}{Band5+Band4}\\]. Diese Formel können wir in den Raster Calculator eingeben (Abb. 7.20) und erhalten dann einen NDVI Raster. Figure 7.20: Eingabe im Raster Calculator um den NDVI zu berechnen Nachdem wir diesen mit einer Farbpalette die von braun über weiß zu grün reicht haben wir die folgende Karte (Abb. 7.21). Figure 7.21: NDVI Landau "],["karten-speichern.html", "8 Karten speichern", " 8 Karten speichern Bevor wir eine Karte speichern können, müssen wir Daten in QGIS geladen haben. Also laden wir unseren Landkreis, die Flüsse des Landkreises und die Beobachtungen der Kohlmeisen aus unserem Landkreis. Denkt daran, dass ihr die Meisen mit dem Data Source Manager (Strg + L) öffnen müsst (siehe [hier][Der Data Source Manager]), da sie als .csv Datei gespeichert sind. Danach in QGIS auf Projekt und dann auf new print layout klicken (Abb. 8.1). Alternativ öffnet ihr den print composer auch mit Strg + P. Figure 8.1: Öffnen des Print Composers Daraufhin werdet ihr aufgefordert einen Namen einzugeben. In der Praxis gebt ihr hier einen Namen ein der zu eurer Karte passt. Heute benutzen wir einfach print composer test. Jetzt sollte sich ein neues Fenster geöffnet haben. Genau wie das Hauptprogramm zeichnet sich der Print Composer durch eine unübersichtliche Anzahl an Knöpfen aus. Wir werden uns hier auf die wesentlichen Funktionen beschränken, eine ausführlichere Beschreibung findet ihr hier, leider müsst ihr beachten, das diese sich auf eine ältere Version von QIGS bezieht und die aktuelle Hilfeseite keine dedizierte Seite für den Print Composer hat. Figure 8.2: Der leere Print Composer In der linken Leiste sind eine Reihe von Symbolen. Als ersts klicken wir auf . Dann ziehen wir mit gedrückter linker Maustaste ein Rechteck, dass das Papier in der Mitte füllt (Abb. 8.3) Figure 8.3: Hinzufügen der Karte mit Add Map Wenn ihr jetzt die linke Maustaste loslasst sollte euer Landkreis mit Flüssen und Vögeln zu sehen sein (Abb. 8.4). Die eingefügt Ansicht entspricht der akutellen Ansich in QGIS. Wenn ihr also in QGIS zoomt oder eine andere Region betrachtet wird hier etwas anderes eingefügt. Nachdem ihr die Karte im Print Composer eingefügt habt, haben Veränderungen in QGIS allerdings keinen Einfluss mehr auf sie. Figure 8.4: Die hinzugefügt Karte Mit dem Select/ Move Item (siehe Abb. 8.5) könnt ihr das das eingefügt Rechteck verschieben bzw. seine Größe verändern. Figure 8.5: Select/ Move Item Mit dem Symbol darunter (Move item content) könnt ihr den angezeigten Auschnitt verändern, also zoomen oder die Ansicht verschieben. Damit könnt ihr z.B. den angezeigten Ausschnit so vergrößern, dass er die Karte ausfüllt. Figure 8.6: Karte vergrößert mit move item content Mit dem Add Picture Knopf können wir Bilder zu der Karte hinzufügen. Grundlegend gibt es hier zwei Optionen. 1. Symbole aus QGIS oder 2. Bilder von der Festplatte. Die Symbole von QGIS sind die gleichen, die ihr auch für Punktobjekte nutzen könnt. Um ein Bild hinzuzufügen müsst ihr als erstes wieder mit gedrückter linker Maustaste einen Rahmen ziehen. Rechts könnt ihr im Fenster SVG groups zwischen verschiedenen Gruppen und Symbolen wählen (blaue Box Abb. 8.7). Unten können verschiedene Eigenschaften der Symbole (Füllfarbe, Strichstärke und - farbe, etc.) angepasst werden (orange Box 8.7). Um von Symbolen zu eigenen Bildern zu wechseln müsst ihr von SVG image zu Raster image wechseln (gelbe Box in Abb. 8.7) Figure 8.7: Hinzufügen von Symbolen Dort gibt es dann wieder ein Feld in den ihr den Pfad zu dem gewünschten Bild eingeben könnt oder alternativ könnt ihr auf das Symbol klicken und die Datein im Explorer auswählen. In Abbildung 8.8 habe ich das Logo der Universität hinzugefügt, es leicht rotiert (blaue Box) und einen schwarzen Rahmen darum gezogen (orange Box). Figure 8.8: Hinzufügen von Raster Bildern Mit dem Knopf können wir dem Bild Schrift hinzufügen. Wieder müssen wir als erstes einen Rahmen ziehen. Die Box enthält dann den Text Lorem ipsum, die ihr rechts in der Box Main Properties ändern könnt (blaue Box Abb. 8.9). Lorem ipsum ist ein Standardtext im Design und Layout der keinerlei Bedeutung hat und nur dazu da ist eine Fläche mit Text zu füllen. Schriftgröße und -art können unter Appearance \\(\\rightarrow\\) Font angepasst werden (orange Box Abb. 8.9). Dieses Tool kann zum Beispiel genutzt werden um der Karte eine Überschrift zu geben. Figure 8.9: Hinzufügen von Text Mit fügen wir der Karte eine Legende hinzu. Die Einträge der Legende entsprechen den Namen im QGIS Layerpanel und werden angepasst, falls ihr die Namen dort ändern solltet. Im aktuellen Zustand ist die Legende wenig hilfreich. Das können wir verbessern indem wir 1. die Layer umbennen ([siehe hier][Sonstiges]) und 2. in einen Layer Farben nutzen um eine Variable darzustellen(siehe hier). Um die Änderungen in QGIS auch im Print Composer umzusetzten müssen wir im print composer auf die Karte klicken und dann rechts Update Map Preview auswählen (Abb. 8.10). Figure 8.10: Angepasste Legende Mit den Knöpfen darunter können wir verschiedene weitere Formen zur Karte hinzufügen: Eine Kartenmaßstabsleiste, einen Nordpfeil, geometrische Formen, Punkte, Pfeile, etc. . Maßstab und Nordpfeil sind oft nützlich und sollten auf fast jeder Karte hinzugefügt werden (Abb. 8.11). Figure 8.11: Mit Maßstab und Nordstern Zum Schluss können wir die Karte nun in der oberen Leiste als pdf Datei (blaue Box Abb. 8.12) oder jpg Datei (orange Box) speichern. Figure 8.12: Speichern der Karte "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
