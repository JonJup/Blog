[["index.html", "Einführung in GIS - QGIS 1 Intro", " Einführung in GIS - QGIS Jonathan Jupke 2022-05-20 1 Intro Wilkommen im Skript für den praktischen Teil der GIS Vorlesung. Falls ihr Schiftart oder -größe ändern wollt, oben links das A. Wenn Abbildungen zu klein sind könnt ihr sie mit Rechtsklick in einem neuen Tab öffnen. "],["erste-schritte.html", "2 Erste Schritte 2.1 Was sehe ich hier? 2.2 Wie lade ich Daten? 2.3 Sonstiges 2.4 Plug-ins", " 2 Erste Schritte 2.1 Was sehe ich hier? Mein QGIS ist auf Englisch eingestellt. Falls dich der Sprachunterschied stört, kannst du die Sprache deines QGIS ändern unter Settings \\(\\rightarrow\\) Options (Abb. 2.1). Figure 2.1: Allgmeine Optionen öffnen um die Sprache zu ändern Dort links den obersten Eintrag General wählen und die Sprache ändern. Allerdings nur im oberen Feld (user interface translation). Das Feld darunter sollte auf Germany eingestellt bleiben. 2.2 Wie lade ich Daten? 2.2.1 Der Data Source Manager 2.3 Sonstiges Den Namen von Layern im Layerpanel könnt ihr ändern, indem ihr nach einem Rechtsklick auf den Layer im Layerpanel Rename Panel wählt oder F2 drückt. 2.4 Plug-ins "],["symbologie.html", "3 Symbologie", " 3 Symbologie "],["karten-speichern.html", "4 Karten speichern", " 4 Karten speichern Bevor wir eine Karte speichern können, müssen wir Daten in QGIS geladen haben. Also laden wir unseren Landkreis, die Flüsse des Landkreises und die Beobachtungen der Kohlmeisen aus unserem Landkreis. Denkt daran, dass ihr die Meisen mit dem Data Source Manager (Strg + L) öffnen müsst (siehe hier), da sie als .csv Datei gespeichert sind. Danach in QGIS auf Projekt und dann auf new print layout klicken (Abb. 4.1). Alternativ öffnet ihr den print composer auch mit Strg + P. Figure 4.1: Öffnen des Print Composers Daraufhin werdet ihr aufgefordert einen Namen einzugeben. In der Praxis gebt ihr hier einen Namen ein der zu eurer Karte passt. Heute benutzen wir einfach print composer test. Jetzt sollte sich ein neues Fenster geöffnet haben. Genau wie das Hauptprogramm zeichnet sich der Print Composer durch eine unübersichtliche Anzahl an Knöpfen aus. Wir werden uns hier auf die wesentlichen Funktionen beschränken, eine ausführlichere Beschreibung findet ihr hier, leider müsst ihr beachten, das diese sich auf eine ältere Version von QIGS bezieht und die aktuelle Hilfeseite keine dedizierte Seite für den Print Composer hat. Figure 4.2: Der leere Print Composer In der linken Leiste sind eine Reihe von Symbolen. Als ersts klicken wir auf . Dann ziehen wir mit gedrückter linker Maustaste ein Rechteck, dass das Papier in der Mitte füllt (Abb. 4.3) Figure 4.3: Hinzufügen der Karte mit Add Map Wenn ihr jetzt die linke Maustaste loslasst sollte euer Landkreis mit Flüssen und Vögeln zu sehen sein (Abb. 4.4). Die eingefügt Ansicht entspricht der akutellen Ansich in QGIS. Wenn ihr also in QGIS zoomt oder eine andere Region betrachtet wird hier etwas anderes eingefügt. Nachdem ihr die Karte im Print Composer eingefügt habt, haben Veränderungen in QGIS allerdings keinen Einfluss mehr auf sie. Figure 4.4: Die hinzugefügt Karte Mit dem Select/ Move Item (siehe Abb. 4.5) könnt ihr das das eingefügt Rechteck verschieben bzw. seine Größe verändern. Figure 4.5: Select/ Move Item Mit dem Symbol darunter (Move item content) könnt ihr den angezeigten Auschnitt verändern, also zoomen oder die Ansicht verschieben. Damit könnt ihr z.B. den angezeigten Ausschnit so vergrößern, dass er die Karte ausfüllt. Figure 4.6: Karte vergrößert mit move item content Mit dem Add Picture Knopf können wir Bilder zu der Karte hinzufügen. Grundlegend gibt es hier zwei Optionen. 1. Symbole aus QGIS oder 2. Bilder von der Festplatte. Die Symbole von QGIS sind die gleichen, die ihr auch für Punktobjekte nutzen könnt. Um ein Bild hinzuzufügen müsst ihr als erstes wieder mit gedrückter linker Maustaste einen Rahmen ziehen. Rechts könnt ihr im Fenster SVG groups zwischen verschiedenen Gruppen und Symbolen wählen (blaue Box Abb. 4.7). Unten können verschiedene Eigenschaften der Symbole (Füllfarbe, Strichstärke und - farbe, etc.) angepasst werden (orange Box 4.7). Um von Symbolen zu eigenen Bildern zu wechseln müsst ihr von SVG image zu Raster image wechseln (gelbe Box in Abb. 4.7) Figure 4.7: Hinzufügen von Symbolen Dort gibt es dann wieder ein Feld in den ihr den Pfad zu dem gewünschten Bild eingeben könnt oder alternativ könnt ihr auf das Symbol klicken und die Datein im Explorer auswählen. In Abbildung 4.8 habe ich das Logo der Universität hinzugefügt, es leicht rotiert (blaue Box) und einen schwarzen Rahmen darum gezogen (orange Box). Figure 4.8: Hinzufügen von Raster Bildern Mit dem Knopf können wir dem Bild Schrift hinzufügen. Wieder müssen wir als erstes einen Rahmen ziehen. Die Box enthält dann den Text Lorem ipsum, die ihr rechts in der Box Main Properties ändern könnt (blaue Box Abb. 4.9). Lorem ipsum ist ein Standardtext im Design und Layout der keinerlei Bedeutung hat und nur dazu da ist eine Fläche mit Text zu füllen. Schriftgröße und -art können unter Appearance \\(\\rightarrow\\) Font angepasst werden (orange Box Abb. 4.9). Dieses Tool kann zum Beispiel genutzt werden um der Karte eine Überschrift zu geben. Figure 4.9: Hinzufügen von Text Mit fügen wir der Karte eine Legende hinzu. Die Einträge der Legende entsprechen den Namen im QGIS Layerpanel und werden angepasst, falls ihr die Namen dort ändern solltet. Im aktuellen Zustand ist die Legende wenig hilfreich. Das können wir verbessern indem wir 1. die Layer umbennen (siehe hier) und 2. in einen Layer Farben nutzen um eine Variable darzustellen(siehe hier). Um die Änderungen in QGIS auch im Print Composer umzusetzten müssen wir im print composer auf die Karte klicken und dann rechts Update Map Preview auswählen (Abb. 4.10). Figure 4.10: Angepasste Legende Mit den Knöpfen darunter können wir verschiedene weitere Formen zur Karte hinzufügen: Eine Kartenmaßstabsleiste, einen Nordpfeil, geometrische Formen, Punkte, Pfeile, etc. . Maßstab und Nordpfeil sind oft nützlich und sollten auf fast jeder Karte hinzugefügt werden (Abb. 4.11). Figure 4.11: Mit Maßstab und Nordstern Zum Schluss können wir die Karte nun in der oberen Leiste als pdf Datei (blaue Box Abb. 4.12) oder jpg Datei (orange Box) speichern. Figure 4.12: Speichern der Karte "],["koordinatenbezugssysteme.html", "5 Koordinatenbezugssysteme 5.1 Wie finde ich heraus wie meine Daten projeziert sind? 5.2 Wie ändere ich das Koordinatenbezugssystem meiner Daten? 5.3 Wie finde ich das Koordinatenbezugssystem herraus?", " 5 Koordinatenbezugssysteme 5.1 Wie finde ich heraus wie meine Daten projeziert sind? Klickt mit der rechten Maustaste auf den Layer von dem ihr die aktuelle Projektion wissen wollt und wählt dann Properties, die unterste Option. Klick hier ganz oben auf Information . Im dritten Feld von oben (Coordinate Reference System (CRS)) findet ihr die Informationen. 5.2 Wie ändere ich das Koordinatenbezugssystem meiner Daten? Hier gibt es zwei Möglichkeiten. Eure Daten haben CRS X aber wurden, fälschlicherweise, in CRS Y geladen. In diesem Szenario wollt ihr die Daten nicht reprojezieren sondern nur eine Einstellung ändern. Das könnt ihr mit im Properties (siehe hier) im Reiter Source . Das Fenster seht ihr in Abbilding 5.1 Figure 5.1: Source Fenters Im obersten Fenster wählt ihr den Layer den ihr anpassen wollt. Darunter könnt auf die aktuelle Auswahl klicken um eine Liste mit kürzlich verwendeten oder geläufigen Alternativen angezeigt zu bekommen. Falls das gesuchte CRS nicht dabei ist könnt ihr mit einem Klick auf den Knopf ein Fenster öffnen in dem ihr mithilfe des EPSG Codes jedes CRS finden könnt, das QGIS kennt. Falls ihr die Daten reprojezieren wollt, sie also in CRS X geladen sind und auch in diesem Format vorliegen, aber ihr sie in CRS Y haben wollt, geht das über das reproject layer Tool (Abb. 5.2). Figure 5.2: Reproject Layer Im erscheinenden Fenster einfach den Layer auswählen den ihr reprojezieren wollt (Input Layer) und unter Target CRS das Ziel CRS auswählen. Dann auf Run klicken. 5.3 Wie finde ich das Koordinatenbezugssystem herraus? Folgendes Szenario: Ihr habt einen Datensatz erhalten mit räumlichen Koordinaten und Namen der Orte. Ihr wisst aber nicht in welchem Koordinatenbezgssystem (KBS) und in welcher Projektion die Daten vorliegen. Dabei kann euch die Website http://projfinder.com/ weiterhelfen. Die Seite ist zweigeteilt (Abb. 5.3). Figure 5.3: projfinder.com Auf der linken Seite seht ihr zwei Eingabefelder und auf der rechten eine Karte mit Fadenkreuz. Angenommen ihr wisst nicht welche Projektion die Kohlmeisendaten haben, könntet ihr in der Spalte locality weitere Informationen zur Probestelle finden. Einen Ausschnit meiner Tabelle seht ihr in Abbildung 5.4. Figure 5.4: Kohlmeisendaten In Reihe elf sehe ich das eine Beobachtung aus Bad Harzburg stammt und die Koordinaten 51.87653 und 10.556916 hat. Nun kann ich auf projfinder.com auf der rechten Karte Bad Harzburg auswählen, links die beiden Koordinante eingeben und dann find find my projection klicken. Dann tauch unter dem find my projection Knopf eine Tabelle auf (Abb. 5.5). Figure 5.5: Auswahl der besten Projektionen In der Tabelle sind verschiedene Projektionen aufgeführt und die Distanz die der Punkt mit den angegeben Koordinatne in der jeweiligen Projektion zu dem von uns mit dem Fadenkreuz gewähten Punkt hat. In unserem Fall wissen wir das die Daten in dem nicht projezierten Koordinatenbezugssystem WGS 84 vorliegen. Das ist erst an Stelle neun, aber die Unterschiede zwischen den zehn aufgeführten KBS bzw. Projektionen bewegen sich im Zentimeterbereich. Falls eure Daten nur eine kleine Fläche bedecken, so wie unsere Maisendaten, ist es egal welche der hier angegebenen Projektionen ihr wählt. Alle passen für diese Region gut. Falls ihr einen größeren Datensatz habt (ganz Deutschland oder Europa) solltet ihr das Verfahren mit mehreren Punkten wiederholen und die Projekten mit der insgesammt kleinsten Abweichung wählen. Die gewählten Punkte sollten möglichst weit von einander entfernt liegen. In diesem Beispiel könnt ihr die Ortbeschreibungen vermutlich gut finden, da es eure eigenen Landkreise sind. Falls ihr mit Ortsnamen in den Daten nichts anfangen könnt, hilft Google Maps. Aufgabe Ladet die Datensätze astast_test_01.csv und astast_test_02.csv aus Olat herunter (Ordner Vorlesung 4) Nutzt projfinder.com um herauszufinden in welchen Projektionen diese beiden Datensätze vorliegen. "],["digitalisierung.html", "6 Digitalisierung 6.1 Keycoding 6.2 Erstellen eines neuen Vektorlayers", " 6 Digitalisierung 6.1 Keycoding In diesem Abschnitt werden wir einem existierenden Vektorlayer eine neue Spalte hinzufügen. Das könnte in der Praxis dem Fall sein, wenn ihr neue Daten zu bereits digitalisierten Objekten erhalten oder erhoben habt und dies nun nachtragen wollt. Bitte ladet für diese Beispiel den Polygon Vektorlayer mit eurem Landkreis. Falls dieser noch geladen ist, müsst ihr ihn nicht neu laden. Geht nun in die Attributtabelle, entweder über Rechtsklick im Layerpanel oder über F6, wenn der Layer im Layerpanel ausgewählt ist. Dort müssen wir als erstes den Bearbeitungsmodus öffnen. Das könnt ihr indem ihr oben links auf den Stift klickt oder mit Strg+E. Nun sind einige der vorher grauen Symbole in der oberen Leiste farbig geworden. Darunter auch das Symbol New Field (Abb. 6.1). Figure 6.1: Bearbeitungsmodus in der Attributtabelle Wenn ihr darauf klickt erscheint das folgende Fenster (Abb. 6.2): Figure 6.2: Hinzufügen einer neuen Spalte Im ersten Feld gebt ihr den Namen der neuen Spalte ein, am Besten ohne Leerzeichen und Umlaute. Das mittlere Feld kann leer gelassen werden. Im unteren Feld wählt ihr den Typ der Variable aus. Die Optionen sind ganze Zahlen (Integer) mit 32 oder 64 bit, Kommazahlen (decimal number (real)), Text (string), Datum und Boolean. 64 bit Integer braucht ihr nur für Zahlen &gt; 2147483647. Boolean sind logische Werte also entweder TRUE oder FALSE. Für unser Beispiel wählen wir Integer 32 bit und kilcken dann ok. Nun sollte die neue Spalte in der Tabelle sein. Ihr könnt in die leeren Zellen der neuen Spalte klicken um dort Werte einzutragen. 6.2 Erstellen eines neuen Vektorlayers Wir können Daten aus Hintergrundkarten digitalisieren, indem wir diese quasi abpauschen. Dafür laden wir als erstes die openstreetmap Hintergrundkarte (Abb. 6.3). Figure 6.3: OpenStreetMap Hintergrundkarte Falls ihr das OpenLayers Plugin nicht installiert habt, tut dies bitte jetzt ([Plug-ins installieren][# Plug-ins]). Nun könnt ihr in eurem Kreis einige Häuser ausschen die ihr digitalisieren wollt. Zoomt zu diesem Haus und klickt dann auf Layer \\(\\rightarrow\\) Create Layer \\(\\rightarrow\\) New Shapefile Layer. Dann sollte das folgende Fenster erscheinen (Abb. 6.4). Figure 6.4: OpenStreetMap Hintergrundkarte Hier könnt ihr den neuen Layer als Datei speichern (blau), einen Geometrietyp wählen (Punkt, Linie oder Polygon; orange) und eine Attributtabelle anlege (gelb). Wir werden einen Polygonlayer erstellen und eine Variable mit dem Namen Name in der Attributtabelle anlegen. Wenn ihr auf Ok klickt erscheint der neue Layer im Layerpanel. Aber er hat noch keine Geometrien. Um die zu erstellen aktivieren wir den Editing Mode (Abb. 6.5). Figure 6.5: OpenStreetMap Hintergrundkarte Zwei Knöpfe weiter rechts ist nun der Knopf AddPolygon Feature farbig geworden. Wenn ihr diesen Knopf auswählt erscheint ein Fadenkreuz. Mit jeden Kilck der linken Maustaste setzt ihr einen neuen Eckpunkt für euer Polygon. Die Verbindung zwischen dem ersten Punkt und dem zuletzt neu erstellten Punkt wird automatisch gezogen. Die Linien dürfen sich nicht überlappen. Solche Kreuzungen werden mit grünen Kreuzen markiert (Abb. 6.6). Wenn ihr fertig mit einem Polygon seit klickt auf die rechte Maustaste. Nun erscheint ein Fenster in dem ihr Werte für die vorher angelegten Variablen eingeben könnt. Die Variable fid (feature ID) gibt es immer und wir können den Eintrag autogenerate stehen lassen. Klick nun auf ok und ein neuer Polygon sollte erscheinen. Falls dies nicht der Fall ist guckt ob der OpenStreetMapLayer vielleicht darüber liegt. Figure 6.6: Erstellen von eigenen Polygonen Aufgabe Digitaliersiert fünf Häuser in euren Kreis. Mit diesen neu erstellten Polygonen können wir eine Reihe von Operationen ausführen. Wir können mit dem Vertex Tool (Abbildung 6.7 orange Box) die Eckpunkte verschieben oder neue Eckpunkte zwischen zwei bestehende Punkte setzten. Wir können sie verschieben (Abb. 6.7 - 1), drehen (2), vergrößern und verkleinern (3), vereinfachen (4), ein Loch einfügen (5), puffern (auch negativ, 6) oder Grenzen ziehen und das eine Polygon damit in mehrere Formen und folglich auch mehrere Einträge in der Attributtabelle umwandeln. Figure 6.7: Verändern von Polygonen "],["vektoroperationen.html", "7 Vektoroperationen 7.1 Geoprocessing 7.2 Misc", " 7 Vektoroperationen Alle hier beschriebenen Vektoroperationen findet ihr unter dem Reiter Vektor (Abb. 7.1). Figure 7.1: Hier findet ihr Vektoroperationen 7.1 Geoprocessing Das erste Feld bei den Vektoroperationen ist Geoprocessing. Hier sind die geläufigen und in der Vorlesung besprochenen Vektoroperationen beheimatet. Es folgt eine kurze Übersicht über die Funktionen. Mehr Details gibt es hier. 7.1.1 Buffer Mit dieser Funktion könnt ihr einen Puffer um Vektorobjekte legen. Im obersten Feld (blau Abb. 7.2) wählt ihr den Layer den ihr puffern wollt. Wie ihr seht gibt es hier auch den Knopf. Ihr könnt also auch neue Daten laden und dirket puffern. Falls eure Daten in einem Koordiantensystem projeziert sind, dass mit Längen- und Breitengrad arbeitet (z.B. EPSG:4326) bekommt ihr eine Warunung (grün Abb. 7.2). In der Regel sind Pufferdistanzen leichter in Metern anzugeben als in Längen- bzw. Breitengraden. Je weiter wir vom Äquator entfernt sind, desto größer wird zusätzlich der Unterschied zwischen einem Grad Länge und einem Grad Breite. Am Besten transformiert ihr eure Daten also in ein KBS das in Metern misst, wie z.B. UTM 32N (EPSG: 25832). Wie das geht seht ihr hier. Figure 7.2: Die Puffer-Funtion Mit den reprojezierten Daten bekommen wir keine Warnung mehr. In Abbilding 7.3 seht ihr einen zehn Meter Buffer rund um die Flüsse meines Landkreises. Aufgabe Zieht Puffern der Größen 10, 100 und 500 Metern um die Flüsse eures Kreises. Wie weit muss der Puffer sein, damit das erste von euch digitalisierte Haus im Puffer liegt? Figure 7.3: 10 Puffer rund um die Landkreise 7.1.2 Clip Mit Clip können wir eine Teilmenge eines Datensatzes erstellen. Die Daten aus dem Input Layer werden auf diejenigen Beobachtungen reduziert, die innerhalb des Overlay Layers liegen. Also zum Beispiel nur die Flüsse oder Maisenbeobachtugen innerhalb eures Landkreises. 7.1.3 Convex hull Eine Convex Hull ist eine Hülle, die um jedes Elemente des Input Layers gezogen wird. Es ist nicht die Hülle die man um eine Gruppe von Punkten legen würde. Daher funktioniert dies Funktion eigentlich nur bei Linien oder Polygonen. In Abbildung 7.4 seht ihr die Flüsse in meinem Landkreis, eingefärbt nach ihrer OBJECTID (sieht hier). Figure 7.4: Flüsse im Landkreis nach OBJECTID eingefärbt Jede dieser Linien besteht aus mehreren Punkten die in einer bestimmten Reihenfolge miteinander verbunden sind. Mit der Convex Hull Funktion ziehen wir nun eine Hülle um all Punkte einer Linie und das für jede Linie (Abb. 7.5). Figure 7.5: Convex Hull um Flüsse Um eine Convex Hull um alle Elemente eines Layers zu ziehen siehe die Minimum bounding geometry Funktion. 7.1.4 Difference Difference ist das Gegenteil von Clip. Bei dieser Funktion werden alle Elemente behalten, die außerhalb des Overlay Layers liegen. 7.1.5 Dissolve Mit Dissolve kann die Anzahl an Features in einem Layer reduziert werden, indem alle Felder mit gleichem dissolve field kombiniert werden. Als Beispiel können wir den ursprünglichen GADM Layer nehmen. Abbildung 7.6 zeigt links den original Layer und rechts den Layer nachem Dissolve mit x als dissolve feature angewandt. wurde. All die Bezirke mit dem Gleichen Landkreis (NAME2) sind nun ein Feature. Figure 7.6: Dissolve von GADM Deutschland anhand der Varable NAME2 Aufgabe Löst die Grenzen der einezlnen Bereiche in eurem Landkreis auf. 7.1.6 Intersection Bei der Verschneidung oder Intersection ist das Ziel, die Attribute eines Objektes mit denen eines anderen zu Kombinieren. Nehmen wir zum Beispiel den GADM Layer von Deutschland. Zustäzlich zu den Informationen die wir bereites zu jeden Feature haben, wollen wir nun wissen in welche Ökoregionen (nach Illies, Daten hier) die Landkreise Fallen. Abbildung 7.7 zeigt beide Layer. Klar ist zu sehen, dass verschiedene Ökoregionen in Deutschland vorkommen. Ihr seht auch, dass ich immernoch den dissolved GADM Layer aus dem vorherigen Abschnitt benutze. Figure 7.7: Dissolve von GADM Deutschland anhand der Varable NAME2 In der nächsten Abbilung sehen wir das Ergebnis von einer Verschneidung mit den Ökoregionen als Input Layer und den GADM Layer als Overlay Layer. Die einzelnen Features sind nach der Ökoregion eingefäbt. Wie wir sehen, erhalten wir den Umriss des GADM Layers also des Overlay Layers. Die einzelen Features sind fast alle wieder die ursprünglichen Bezirke vor dem Dissolve. Dort wo einzelne Bezirke mehrere Ökoregionen enthalten, bzw. die Grenze zwischen zwei Regionen durch einen Bezirk verläuft, wurde der Bezirk an dieser Grenze in zwei Feature getrennt. Jedes Feature enthält nun sowol die Informationen aus dem GADM als auch aus dem Ökoregionen Layer. Figure 7.8: Ergebnis der Verschneidung von Ökoregionen und GADM 7.1.7 Union Mit Union kombinieren wir Elemente. Das können Elemente eines Layers sein oder aus verschiedenen. Wenn wir die Elemente eines Layers kombinieren wollen geben wir diesen Layer als Input Layer an und lassen Overlay Layer leer. In Abbildung 7.9 seht ihr ein Beispiel dafür. Hier sind drei Polygone, jedes überlappt mit jedem anderen und in der Mitte überlappen alle drei. Figure 7.9: Beispielpolygone bevor Union angewandt wurde Die zugehörige Attributtabelle hat drei Spalten ID, Zahl und Text. Alle drei geben die Nummer des Polygons wieder (Abb. 7.10). Figure 7.10: Attributtabelle der Beispielpolygone bevor Union angewandt wurde Wenden wir Union auf diesen Layer an erhalten wir die Layer aus Abbildung 7.11. Figure 7.11: Beispielpolygone nachdem Union angewandt wurde Die zugehörige Attributtabelle ist in Abbildung 7.12 ist zu sehen. Figure 7.12: Attributtabelle der Beispielpolygone nachdem Union angewandt wurde Nun gibt es für jede überlappende Fläche eigene Polygone. Für eine Fläche auf der Polygon eins und zwei überlappen gibt es nun ein Polygon für Polygon eins und eins für zwei. In der Mitte, wo alle drei überlappen, gibt es nach Union drei Polygone – eines für jeden Original Layer. Am deutlichsten ist das zu sehen, wenn wir nur die Elemente mit einer ID anzeigen lassen (Abbildung 7.13). Hier sehen wir, dass die Form des ursprünglichen Rechtecks erhalten bleibt, wir nun allerdings vier anstelle von einem Polygon haben: einen für die Fläche die nicht überlappt (unten rechts), einen für die Fläche die mit dem linken Polygon überlappt (unten links), einen für die Fläche die mit dem oberen Polygon überlappt (oben rechts) und einen für die Fläche die mit beiden anderen Flächen überlappt (oben links). Die beiden anderen Polygon wurden genauso aufgeteilt. Figure 7.13: Eines der ursprünglichen Polygone nach Union Wie bereits erwähnt können wir Union auch mit zwei verschiedenen Layer nutzen. Dafür habe ich einen zweiten Beispiellayer erstellt (Abb. 7.14). Figure 7.14: Beide Beispiellayer Diesen wähle ich nun als Overlay Layer im Union Fenster. Der Ergebnis beinhaltet alle vier ursprünglichen Polygone sowie die Flächen in dennen Polygone aus dem ersten und zweiten Layer überlappen als eigene Polygone (Abb. 7.15). Figure 7.15: Ergebniss von Union mit zwei Layern Flächen in denen Polygone aus dem ersten Layer überlappen sind diesmal keine eigenen Flächen. Ein Blick in die Attributtabelle zeigt, dass alle Elemente des neuen Layers alle Attribute beider ursprünglichen Layer haben (Abb. 7.16. Figure 7.16: Attributtabelle nach Union mit zwei Layern 7.2 Misc 7.2.1 Minimum bounding geometry Mit Minimum bounding geometry können wir verschiedene Polygone um die Elemente eines Layers ziehen. Die Funktion findet ihr in der Processing Toolbox. Bei Input Layer wählt ihr den Layer um dessen Elemente ihr das Polygon ziehen wollt. Welches Polygon ihr berechnen wollt wählt ihr mit dem Geometry type Argument. Envelope (Bounding box) ist das kleinste Rechteck, das alle Elemente enthält, wobei die Seiten parallel zu Meridianen und Parallelen sind. Bei Minimum Orientet Rectangle erhalten wir ein das kleinste Rechteck das nicht parallel zu Meridianen und Parallelen sein muss, Minimum Encolsing Circle ist der kleinste Kreis, und Convex Hull ist die Convex Hull. "],["rasteroperationen.html", "8 Rasteroperationen 8.1 Einführung 8.2 Darstellung 8.3 Rasteralgebra 8.4 Terrain Analysis", " 8 Rasteroperationen 8.1 Einführung Als erstes Beispiel nutzen wir hier ein DEM für Deutschland. Die Datei DEM-32N-clip.tif findet ihr in OLAT im Ordner Vorlesung 1. Wir laden die Datei über den Data Source Manage (Strg + L). Im Data Source Manager wählt ihr links den Reiter Raster und bei **Raster dataset(s) könnt ihr mit einem Klick auf die gewünschte Datei auf dem Computer auswählen. Der Raster erscheint nun in schwarz-weiß (Abb. 8.1). Figure 8.1: DEM für Deutschland nach dem Laden Helle Regionen sind höher und dunklere tiefer. Links im Layer Panel wird euch die Farbskala mit Minimal- und Maximalwert angezeigt. Wie bei einem Vektor Layer können wir mit Rechtsklick auf den Layer über Properties die meisten wichtigen Informatonen abrufen und einge Eigenschaften anpassen. Oben im Properties Fenster seht ihr den Information (; Abb. 8.2) Reiter . Figure 8.2: Information Reiter in Properties Fenster Unter der Überschift General sehen wir Informationen zum Namen (Name), dem Dateipfad (Path), der Dateigröße (Size), dem Datum an dem die Datei das letzt mal verändert wurde (Last modified) sowie der Software die genutzt wurde um die Datei in QGIS zu laden (Provider). Danach kommen nähere Informationen zu den Eigenschaften des Rasters. Das Ausmaß (Extent) also die jeweils größten und kleinsten X- und Y-Koordinaten. Width und Height geben die Anzahl der Spalten und Reihen des Rasters an. Der Data type beschreibt die Art der Variable die inden einzelnen Zellen gespeichert ist. In diesem Fall Float32 also eine Kommazahl (floating point number) bei der für jede Zahl 32 bit (binary digits) freigehalten werden. Mit 64 bit könnte man mehr verschiedene Zahlen darstellen (\\(2^{64}\\) anstelle von \\(2^{32}\\)) aber die Datei wäre größer. Der GDAL Driver gibt an welchen Treiber GDAL (der Provider) benutzt hat um die Datei zu laden. Unter Band1 sehen wir zusammenfassende Informationen zum ersten Band (und in diesem Fall einzigen Band). Was ist der maximale Wert, der minimale, der Mittelwert und die Standardabweichung. 8.2 Darstellung Unter Symbology (, Abb. 8.3) können wir die Darstellung anpassen. Figure 8.3: Raster Symbologie Die wichtigste Einstellung hier ist gleich die oberste: Render type. In dem drop-down Menü gibt es die Auswahlmöglichkeiten: Multiband Color, Paletted/ Unique Values, Singleband grey, Singleband pseudocolor, Hillshade und Contours. Standardmäßig ist hier Singleband grey eingestellt. Die Render type Einstellung bestimmt was für Optionen und Fenster im restlichen Menü zu sehen sind. Bei Singleband grey können wir unter Color gradient den Gradienten umdrehen (hohe Werte dunkel tiefe Werte hell). Darunter werden der Maximal- und Minimalwert angezeigt und bei contrast enhancement können wir mithilfe dieser Zahlenspanne die Darstellung anpassen. Mit der Einstellung no enhancement habe alle Zellen die gleiche Farbe. Mit Strech to MinMax wird der schwarz-weiß Gradient an die angegebene Minimal- und Maximalwerte angepasst. Diese Werte müssen nicht den tasächlichen Werten des Rasters entsprechen. Ihr könnt auch nur einen Teil davon für den Gradienten nutzen. Alle Werte die über dem Maximum liegen bzw. alle Werte die unter dem Minimum liegen bekommen die gleiche Farbe wie das Maximum bzw. Minimum. Mit Stretch and Clip to MinMax werden Zellen mit Werten außerhalb des angegebenen Zahlenraums entfernt. Bei unserem DEM können wir so die negativen Werte entfernen. Clip to MinMax entfernt Zellen mit Werten außerhalb des angegebenen Zahlenraumes ohne die restlichen Zellen einzufärben. Bei Singleband pseudocolor können wir eine anderen Farbgradienten wählen als schwarz-weiß. Den Farbgraident wählt ihr mit dem kleinen Pfeil rechts des Gradienten bei color ramp. Im Fenster darunter seht ihr die Farben, die den jeweiligen Zahlenbereichen zugeordnet sind. Unter dem Fenster könnt ihr bei Mode ändern wie die Farben den Zahlenbereichen zugeordnet werden. Mit Equal Interval wählen wir, dass die Gruppen zwischen Minimalwert und Maximalwert alle die gleiche Menge an Höhenmetern abdecken. Mit Classes können wir die Anzahl an Gruppen anpassen. Die Einstellung Paletted/ Unique Values ist für Raster geeignet die kategorische Variablen darstellen wie z.B. Landnutzungstyp. Hier bekommt jeder Werte eine eingene Farbe und die Farben liegen nicht auf einem gemeinsamen Farbgraidenten. Die Farben sollten möglichst unterschiedlich sein, damit die Kategorien klar voneinenander unterscheidbar sind. Als Beispiel zeige ich hier die CORINE Land Cover Daten. In Abbildung 8.4 ist die schwarz-weiß Darstellung und das Symbologiefenster von Paletted/ Unique Values. Figure 8.4: CORINE Landcover Daten in schwarz-weiß Wenn wir dort auf classify klicken wird jedem Wert des Rasters eine Farbe zugeordnet. Nachdem wir auf Apply klicken. Abbildung 8.5 zeigt einen Ausschnitt der so erstellten Karte. Figure 8.5: CORINE Landcover Daten mit Paletted Values Die Einstellung Multiband Color ist für Raster mit mehreren Bändern geeignet. Das sind vorallem Satellitenfotos. Ein Beispiel für so eine Datei ist orthophoto.tif im Ordner Vorlesung 5. Ihr könnt die Datei wie jeden anderen Raster auf in QGIS laden. In QGIS werden die drei Bänder der Datei im Layer Panel angezeigt. Jedes Band entählt die Intensität von einer Farbe Band 1 rot, Band 2 Grün und Band 3 Blau. Jedes Band reicht von 0 bis 255, hat also 256 Werte, was sich mit einem 8bit Integer (\\(2^8 = 256\\)) speichern lässt. Auf diese Art und Weise lassen sich Farben mit ihrem RGB (rot, grün, blau) Wert speichern. Die Extremata sind schwarz (0,0,0) und weiß (255,255,255). Für diesen Raster mit drei Bändern hat QGIS automatisch den Render type Multiband Color gewählt. Die letzten beiden Typen Hillshade und Contours werden eher selten genutzt. Erstere täuschen einen 3D Effekt vor und letztere erstellen eine Karte mit Isolinien (beim DEM Isohypsen). Hillshades werden wir im Kapitel Terrain Analysis näher betrachten. 8.3 Rasteralgebra Rasteralgebra ist in QGIS im Raster calculator verfügbar (Abb. 8.6). Figure 8.6: Knopf um den Raster calculator zu öffnen Öffnen wir den Raster calculator, öffnet sich folgendes Fenster (Abb. 8.7). Figure 8.7: Der Raster calculator Alle aktuell geladenen Raster werden im Fenster Raster bands (blau Abb. 8.7) aufgeführt. Befehle für Funktionen (unter Operators) werden im Fenster Raster calculator expression eingegeben (grün Abb. 8.7). Ausdehnung und Reihen- sowie Spaltenzahl können unter Spatial Extent (gelb Abb. 8.7) angepasst werden. Unter Result Layer (orange Abb. 8.7) könnt ihr einstellen ob der resultierende Layer gespeichert werden soll oder nach schließen der aktuellen QGIS Sitzung gelöscht werden soll (Option Create on-the-fly raster …). Bevor ihr die Funktion mit einem Klick auf OK ausführen könnt müsst ihr entweder einen Namen für die zu speichernde Date auswählen oder die create-on-the-fly option markiert haben. 8.3.1 Lokale Funktionen Mathematische Funktionen Mathematische Funktionen können einfach wie bei einem Taschenrechner eingegeben werden. Wenn wir den DEM von Deutschland um 40 Meter erhöhen wollen können wir folgenden Befehl ausführen (Abb. 8.8). Mit anderen mathematischen Funktionen (-, *, /, exp) funktiert das genauso. Figure 8.8: Raster calculator: + Logische Funktionen Um logische Funktionen zu demonstrieren erstellen wir eine Version des DEM in dem nur Zellen mit über 400 Meter Höhe üNN enthalten sind. Figure 8.9: Befehl für Zellen mit Werten größer 400 Das Ergebniss ist ein Raster mit drei verschiedenen Zellwerten: 0 (&lt;=400), 1(&gt;400) und eine sehr große negative Zahl für fehlende Werte (außerhalb von Deutschland). Da wir nun eine kategorische Variable haben ist der Darstellungsstyl Paletted passend (Abb. 8.10). Figure 8.10: Raster mit zwei Höhenklassen Wenn wir nun diesen Layer mit dem Originallayer multiplizieren würde wir einen Layer erhalten, in dem alle Zellen mit einer Höhe von über 400m ihren ursprünglichen Höhenwert haben und alle anderen 0. Reclassification Einfacher geht das allerdings mit dem Reclassification by table Tool, das ihr über die Processing Toolbox öffnen könnt (Abb. 8.11). Figure 8.11: Reclassification by table Unter Reclassification Table könnt ihr mit einem Klick auf eine Tabelle erstellen um eine kontinuierliche Variable (z.B. Höhe) in Klassen einzuteilen. Meine Beispieltabelle seht ihr in Abbildung 8.12. Figure 8.12: Reclassification table Ihr müsst auf OK klicken, damit die Tabelle auch gespeichert wird. Wenn ihr jetzt auf Run klickt wird der neue Raster berechnet. Da es im Fall des DEMs für Deutschland Werte &lt; 0 als kleiner als die untere Grenze der untersten Klasse gibt haben wir mehr als die vier Klassen erhalten (Abb. 8.13). Figure 8.13: Einzelwerte angezeigt bei Paletted Alle Werte die nicht von uns bestimmten Klassen entsprechen können wir löschen indem wir sie auswählen und auf die rote Minus Taste rechts von classify drücken. Für eine bessere Darstellug klicken wir außerdem auf die Farbleiste und wählen im nun erscheinenden Fenster oben rechts Discrete anstelle von Continuous. Die so erzeugte Karte seht ihr in Abbildug 8.14. Figure 8.14: Deutschland in vier Höhenklassen Overlay in Planung. 8.3.2 Fokale Funktionen Um fokale Funktionen außerhalb der Terrainanalyse zu berechnen muss QGIS auf GRASS GIS zurückgreifen. Ihr solltet GRASS GIS in der Processing Toolbox sehen (Abb. 8.15). Figure 8.15: Deutschland in vier Höhenklassen Falls ihr GRASS GIS dort nicht seht kontrolliert ob die beiden GRASS Plugins aktiviert sind. Sucht in der Processing Toolbox nach r.neighbors. In dieser Funktion könnt ihr unter Input Raster Layer den Input Layer wählen, unter Neighborhood operation was für eine Statistik berechnet werden soll und unter Neighborhood Size die Größe des moving window. 8.3.3 Zonale Funktionen Zonale Statistken können in QGIS dem Zonal statistic Tool berechnen. Als Beispiel berechnen wir hier den Mittelwert des DEM für jeden Bezirk in meinem Landkreis. In Abbildung 8.16 seht ihr das Fenster der Zonal statistic Funktion. Figure 8.16: Zonal statistic Tool Bei Input wählen wir den Layer mit den Zonen, für die wir die Werte berechnen wollen. Bei Raster Layer den Raster von dem wir die Werte berechnen wollen. Die berechneten Werte werden der Attirbuttabelle des Inputlayers als Spalten hinzugefügt. Bei Output column prefix könnt ihr einen Präfix für die Spaltennamen wählen. Ich wähle hier den Präfix hoehe_. Unter Statistics to calculate könnt ihr die gewünschten Statistiken auswählen. Standardt ist count, sum und mean. Da wir hier nur am Mittelwert interressiert sind wähle ich nur mean. Abbildung 8.17 zeigt die nach mittlerer Höhe eingefärbten Bezirke. Figure 8.17: Bezirke im Kreis Goslar mit mittlerer Höhe 8.3.4 Globale Funktionen 8.4 Terrain Analysis Die Funktionen der Terrain Analyse findet ihr unter Raster \\(\\rightarrow\\) Analysis. 8.4.1 Gewässernetzwerk Hierfür nutzen wir Funktion aus SAGA GIS. Auch hier gilt, falls ihr SAGA GIS nicht in eurer Processing Toolbox seht, üperprüft ob das entsprechende Plugin aktiviert ist. Als erstes füllen wir die Lücken in unserem DEM mit der Funktion Fill Sinks (Wang &amp; Liu). In der Funktion müssen wir nur unser DEM angeben, die anderen Argumente können unverändert bleiben. Die Funktion erstellt drei Outputs: Flow Directions, Watershed Basins und Filled DEM. Den Filled DEM Layer nutzen wir nun als Input für die Funktion Strahler Oder. Wieder müssen wir aus dem Input Layer keine Argumente ändern oder eingeben. Das Ergebnis seht ihr auf Abbildug 8.18. Figure 8.18: Gewässernetzerk für Deutschland - ohne Grenzwert Um das Netzwerk übersichtlicher zu machen entfernen wir kleinere Gewässer (Stahler Ordnung &lt; 2) mit dem Raster calculator und färben die übriggelbiebenen Gewässer als singleband pseudocolor blau ein (Abb. 8.19). Figure 8.19: Gewässernetzerk für Deutschland "]]
