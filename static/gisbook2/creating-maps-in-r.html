<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Creating Maps in R | Spatial Data Science in R</title>
  <meta name="description" content="Lessons and tasks from GIS courses by Jonathan Jupke" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Creating Maps in R | Spatial Data Science in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Lessons and tasks from GIS courses by Jonathan Jupke" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Creating Maps in R | Spatial Data Science in R" />
  
  <meta name="twitter:description" content="Lessons and tasks from GIS courses by Jonathan Jupke" />
  

<meta name="author" content="Jonathan Jupke" />


<meta name="date" content="2024-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rasters-in-r-the-terra-package.html"/>
<link rel="next" href="where-do-i-get-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/lfx-sidebyside-1.0.0/lfx-side-by-side.js"></script>
<script src="libs/lfx-sidebyside-1.0.0/lfx-side-by-side-bindings.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html"><i class="fa fa-check"></i><b>1</b> Introduction to the sf package</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#loading-spatial-data-into-r"><i class="fa fa-check"></i><b>1.1</b> Loading spatial data into R</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#creating-spatial-data-yourself"><i class="fa fa-check"></i><b>1.2</b> Creating spatial data yourself</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#basic-operations"><i class="fa fa-check"></i><b>1.3</b> Basic operations</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#useful-functions"><i class="fa fa-check"></i><b>1.4</b> Useful functions</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#st_area"><i class="fa fa-check"></i><b>1.4.1</b> <code>st_area</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#st_distance"><i class="fa fa-check"></i><b>1.4.2</b> <code>st_distance</code></a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#st_nearest_feature"><i class="fa fa-check"></i><b>1.4.3</b> <code>st_nearest_feature</code></a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#spatial-subsetting"><i class="fa fa-check"></i><b>1.4.4</b> spatial subsetting</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#spatial-joins"><i class="fa fa-check"></i><b>1.4.5</b> Spatial joins</a></li>
<li class="chapter" data-level="1.4.6" data-path="introduction-to-the-sf-package.html"><a href="introduction-to-the-sf-package.html#spatial-aggregation"><i class="fa fa-check"></i><b>1.4.6</b> Spatial Aggregation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html"><i class="fa fa-check"></i><b>2</b> Point Pattern Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#the-ppp-class"><i class="fa fa-check"></i><b>2.1</b> the ppp class</a></li>
<li class="chapter" data-level="2.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#first-order-processes"><i class="fa fa-check"></i><b>2.2</b> First order processes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#kernel-density"><i class="fa fa-check"></i><b>2.2.1</b> Kernel density</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#second-order-processes"><i class="fa fa-check"></i><b>2.3</b> Second order processes</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>2.3.1</b> Average nearest neighbor</a></li>
<li class="chapter" data-level="2.3.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#the-k-funktion"><i class="fa fa-check"></i><b>2.3.2</b> The K-Funktion</a></li>
<li class="chapter" data-level="2.3.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#morans-i"><i class="fa fa-check"></i><b>2.3.3</b> Morans I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="interpolation.html"><a href="interpolation.html"><i class="fa fa-check"></i><b>3</b> Interpolation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="interpolation.html"><a href="interpolation.html#the-data"><i class="fa fa-check"></i><b>3.1</b> The data</a></li>
<li class="chapter" data-level="3.2" data-path="interpolation.html"><a href="interpolation.html#proximity-polygons"><i class="fa fa-check"></i><b>3.2</b> Proximity Polygons</a></li>
<li class="chapter" data-level="3.3" data-path="interpolation.html"><a href="interpolation.html#trend-surface-analysis"><i class="fa fa-check"></i><b>3.3</b> Trend Surface Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="interpolation.html"><a href="interpolation.html#splines"><i class="fa fa-check"></i><b>3.4</b> Splines</a></li>
<li class="chapter" data-level="3.5" data-path="interpolation.html"><a href="interpolation.html#weighted-averaging"><i class="fa fa-check"></i><b>3.5</b> Weighted averaging</a></li>
<li class="chapter" data-level="3.6" data-path="interpolation.html"><a href="interpolation.html#kriging"><i class="fa fa-check"></i><b>3.6</b> Kriging</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graph-analysis.html"><a href="graph-analysis.html"><i class="fa fa-check"></i><b>4</b> Graph Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="graph-analysis.html"><a href="graph-analysis.html#the-igraph-package"><i class="fa fa-check"></i><b>4.1</b> The igraph package</a></li>
<li class="chapter" data-level="4.2" data-path="graph-analysis.html"><a href="graph-analysis.html#from-data-to-graph"><i class="fa fa-check"></i><b>4.2</b> From data to graph</a></li>
<li class="chapter" data-level="4.3" data-path="graph-analysis.html"><a href="graph-analysis.html#centrality-measures"><i class="fa fa-check"></i><b>4.3</b> Centrality measures</a></li>
<li class="chapter" data-level="4.4" data-path="graph-analysis.html"><a href="graph-analysis.html#visualization"><i class="fa fa-check"></i><b>4.4</b> Visualization</a></li>
<li class="chapter" data-level="4.5" data-path="graph-analysis.html"><a href="graph-analysis.html#network-models"><i class="fa fa-check"></i><b>4.5</b> Network Models</a></li>
<li class="chapter" data-level="4.6" data-path="graph-analysis.html"><a href="graph-analysis.html#optimal-channel-networks"><i class="fa fa-check"></i><b>4.6</b> Optimal Channel Networks</a></li>
<li class="chapter" data-level="4.7" data-path="graph-analysis.html"><a href="graph-analysis.html#sfnetworks"><i class="fa fa-check"></i><b>4.7</b> sfnetworks</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="graph-analysis.html"><a href="graph-analysis.html#finding-paths-in-the-network"><i class="fa fa-check"></i><b>4.7.1</b> Finding paths in the network</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html"><i class="fa fa-check"></i><b>5</b> Rasters in R: The terra package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#basic-idea"><i class="fa fa-check"></i><b>5.1</b> Basic idea</a></li>
<li class="chapter" data-level="5.2" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#creating-a-new-raster"><i class="fa fa-check"></i><b>5.2</b> Creating a new Raster</a></li>
<li class="chapter" data-level="5.3" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#going-beyond-the-hull"><i class="fa fa-check"></i><b>5.3</b> Going beyond the hull</a></li>
<li class="chapter" data-level="5.4" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#multiple-layers-in-one-spatraster"><i class="fa fa-check"></i><b>5.4</b> Multiple layers in one SpatRaster</a></li>
<li class="chapter" data-level="5.5" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#raster-algebra"><i class="fa fa-check"></i><b>5.5</b> Raster algebra</a></li>
<li class="chapter" data-level="5.6" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#high-level-functions"><i class="fa fa-check"></i><b>5.6</b> High-level functions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#extracting-raster-values-with-vectors"><i class="fa fa-check"></i><b>5.6.1</b> Extracting raster values with vectors</a></li>
<li class="chapter" data-level="5.6.2" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#masking"><i class="fa fa-check"></i><b>5.6.2</b> Masking</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="rasters-in-r-the-terra-package.html"><a href="rasters-in-r-the-terra-package.html#cell-level-functions"><i class="fa fa-check"></i><b>5.7</b> Cell-level functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html"><i class="fa fa-check"></i><b>6</b> Creating Maps in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#tmap"><i class="fa fa-check"></i><b>6.1</b> tmap</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#basic-tmaps"><i class="fa fa-check"></i><b>6.1.1</b> Basic tmaps</a></li>
<li class="chapter" data-level="6.1.2" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#adjusting-visual-elements-and-multiple-groups"><i class="fa fa-check"></i><b>6.1.2</b> Adjusting visual elements and multiple groups</a></li>
<li class="chapter" data-level="6.1.3" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#map-extend"><i class="fa fa-check"></i><b>6.1.3</b> Map extend</a></li>
<li class="chapter" data-level="6.1.4" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#further-map-elements"><i class="fa fa-check"></i><b>6.1.4</b> Further map elements</a></li>
<li class="chapter" data-level="6.1.5" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#making-the-map-prettier"><i class="fa fa-check"></i><b>6.1.5</b> Making the map prettier</a></li>
<li class="chapter" data-level="6.1.6" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#save-to-maps-to-file"><i class="fa fa-check"></i><b>6.1.6</b> Save to maps to file</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#rastervis"><i class="fa fa-check"></i><b>6.2</b> rasterVis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#beyond-the-usual"><i class="fa fa-check"></i><b>6.2.1</b> Beyond the usual</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#cartographer"><i class="fa fa-check"></i><b>6.3</b> Cartographer</a></li>
<li class="chapter" data-level="6.4" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#rayshader"><i class="fa fa-check"></i><b>6.4</b> Rayshader</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="creating-maps-in-r.html"><a href="creating-maps-in-r.html#setup"><i class="fa fa-check"></i><b>6.4.1</b> Setup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="where-do-i-get-data.html"><a href="where-do-i-get-data.html"><i class="fa fa-check"></i><b>7</b> Where do I get data❓</a>
<ul>
<li class="chapter" data-level="7.1" data-path="where-do-i-get-data.html"><a href="where-do-i-get-data.html#websites"><i class="fa fa-check"></i><b>7.1</b> Websites</a></li>
<li class="chapter" data-level="7.2" data-path="where-do-i-get-data.html"><a href="where-do-i-get-data.html#packages"><i class="fa fa-check"></i><b>7.2</b> Packages</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="where-do-i-get-data.html"><a href="where-do-i-get-data.html#geodata"><i class="fa fa-check"></i><b>7.2.1</b> geodata</a></li>
<li class="chapter" data-level="7.2.2" data-path="where-do-i-get-data.html"><a href="where-do-i-get-data.html#osmdata"><i class="fa fa-check"></i><b>7.2.2</b> osmdata</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="usefull-packages.html"><a href="usefull-packages.html"><i class="fa fa-check"></i><b>8</b> Usefull packages</a>
<ul>
<li class="chapter" data-level="8.1" data-path="usefull-packages.html"><a href="usefull-packages.html#coordinatecleaner"><i class="fa fa-check"></i><b>8.1</b> ‘CoordinateCleaner’</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-maps-in-r" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Creating Maps in R<a href="creating-maps-in-r.html#creating-maps-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter gives you an introduction into basic map creation with R.
We will use a range of packages (<em>currently only tmap implemented</em>) to create both interactive (<em>not yet</em>) and static maps.
Interactive maps are great to explore your data or for interactive documents like html documents and websites. Static maps require more effort but are necessary for static documents, i.e., .pdf, docx., or pptx.
First, we load all the <code>sf</code> package which we need to represent spatial data in R.
We will also load some data to plot.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="creating-maps-in-r.html#cb401-1" tabindex="-1"></a><span class="co"># loading the required packages </span></span>
<span id="cb401-2"><a href="creating-maps-in-r.html#cb401-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb401-3"><a href="creating-maps-in-r.html#cb401-3" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb401-4"><a href="creating-maps-in-r.html#cb401-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb401-5"><a href="creating-maps-in-r.html#cb401-5" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span></code></pre></div>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="creating-maps-in-r.html#cb402-1" tabindex="-1"></a>lucas   <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/lucas_saxony.rds&quot;</span>)</span>
<span id="cb402-2"><a href="creating-maps-in-r.html#cb402-2" tabindex="-1"></a>germany <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/gadm36_DEU_3_pk.gpkg&quot;</span>)</span>
<span id="cb402-3"><a href="creating-maps-in-r.html#cb402-3" tabindex="-1"></a>rivers  <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/rivers_sachsen.gpkg&quot;</span>)</span></code></pre></div>
<p>We will also download a DEM for Saxony with the <code>geodata</code> package <span class="citation">(<a href="#ref-Hijmans2022b">Hijmans, Ghosh, and Mandel 2022</a>)</span>.
The function <code>elevation_30s()</code> downloads a DEM for Germany with a resolution of 30 arc seconds (i.e. one degree divided by 3600). For more details on the <code>geodata</code> package see <a href="https://jonjup.netlify.app/post/the-geodata-package/">here</a>.
The data are downloaded to a folder specified in the <code>path</code> argument.
Afterward, we load the data with the <code>terra</code> package.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="creating-maps-in-r.html#cb403-1" tabindex="-1"></a><span class="fu">library</span>(geodata)</span>
<span id="cb403-2"><a href="creating-maps-in-r.html#cb403-2" tabindex="-1"></a><span class="fu">elevation_30s</span>(<span class="at">country =</span> <span class="st">&quot;DEU&quot;</span>, <span class="at">path =</span> <span class="st">&quot;data/elevation&quot;</span>)</span>
<span id="cb403-3"><a href="creating-maps-in-r.html#cb403-3" tabindex="-1"></a>dem <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/elevation/DEU_elv_msk.tif&quot;</span>)</span></code></pre></div>
<p>All the maps I create as examples here are for Saxony.
So we will extract Saxony from the <code>germany</code> data set and the raster.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="creating-maps-in-r.html#cb404-1" tabindex="-1"></a>saxony <span class="ot">&lt;-</span> <span class="fu">filter</span>(germany, NAME_1 <span class="sc">==</span> <span class="st">&quot;Sachsen&quot;</span>)</span>
<span id="cb404-2"><a href="creating-maps-in-r.html#cb404-2" tabindex="-1"></a>saxony_dem <span class="ot">&lt;-</span> <span class="fu">mask</span>(dem, saxony)</span>
<span id="cb404-3"><a href="creating-maps-in-r.html#cb404-3" tabindex="-1"></a>saxony_dem <span class="ot">&lt;-</span> <span class="fu">crop</span>(saxony_dem, saxony)</span></code></pre></div>
<p>For most object classes, we can use the base <code>plot()</code> function to create a very basic static map.
For <code>sf</code> objects, we get one plot per variable.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="creating-maps-in-r.html#cb405-1" tabindex="-1"></a><span class="fu">plot</span>(lucas)</span></code></pre></div>
<pre><code>## Warning: plotting the first 9 out of 22 attributes; use max.plot = 22 to plot all</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<p>These maps are not very informative and should not be used for reports or presentations.
The defaul plot for rasters is already a lot better.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="creating-maps-in-r.html#cb407-1" tabindex="-1"></a><span class="fu">plot</span>(dem)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
<p>There are several good options to create maps with both rasters and vectors in R.
Some package can create both static and interactive maps and others are specifically designed for one of the two. We will go through several packages in order of decreasing importance.
From my experience you will rarely need other packages than <code>tmap</code> <span class="citation">(<a href="#ref-Tennekes2018">Tennekes 2018</a>)</span> to create good maps.
This is why we start with this package.
However, some packages provide functions that are not available in <code>tmap</code> and so will also cover several other further down.</p>
<div id="tmap" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> tmap<a href="creating-maps-in-r.html#tmap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>tmap</code> is a large package with lots of functions.
We will only scratch the surface here.
For a more in-depth introduction see <a href="https://r-tmap.github.io/tmap-book/">here</a> (at the time of writing the book is still under construction).</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="creating-maps-in-r.html#cb408-1" tabindex="-1"></a><span class="fu">library</span>(tmap)</span></code></pre></div>
<p>Besides the regular maps, tmap can create quickmaps with the <code>qtm()</code> function that can be handy for data exploration.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="creating-maps-in-r.html#cb409-1" tabindex="-1"></a><span class="fu">qtm</span>(lucas)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-251-1.png" width="672" /></p>
<p>These maps are similar to those created by the base <code>plot()</code> function.
The main difference is that we only get one map.
While the beauty of the <code>qtm()</code> function is that we do not need to add any information besides the data set, if we want, we can add more variables.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="creating-maps-in-r.html#cb410-1" tabindex="-1"></a><span class="fu">qtm</span>(lucas, <span class="at">symbols.shape =</span> <span class="dv">24</span>, <span class="at">symbols.size =</span> <span class="st">&quot;EC&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Electrical conductivity&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
<div id="basic-tmaps" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Basic tmaps<a href="creating-maps-in-r.html#basic-tmaps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usually however, you will be using the regular map approach.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="creating-maps-in-r.html#cb411-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> </span>
<span id="cb411-2"><a href="creating-maps-in-r.html#cb411-2" tabindex="-1"></a>        <span class="fu">tm_symbols</span>(<span class="at">shape =</span> <span class="dv">24</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-253-1.png" width="672" /></p>
<p>Here, we first provide the data set we want to plot to the <code>tm_shape()</code> function and then specify how we want to display the data.
Here, we used <code>tm_symbols()</code> but there are many different visual elements we can add to a map.
Some are just shape-explicit versions of <code>tm_symbols</code>.
For example, <code>tm_dots()</code>, <code>tm_squares()</code>, <code>tm_markers()</code>, or <code>tm_bubbles()</code>.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="creating-maps-in-r.html#cb412-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> <span class="fu">tm_dots</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="creating-maps-in-r.html#cb413-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> <span class="fu">tm_bubbles</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-254-2.png" width="672" /></p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="creating-maps-in-r.html#cb414-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> <span class="fu">tm_squares</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-254-3.png" width="672" /></p>
<p>All of these visual elements are applicable to point data.</p>
<p>For polygons and lines we need other elements.
For lines, we use <code>tm_lines()</code>.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="creating-maps-in-r.html#cb415-1" tabindex="-1"></a><span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> <span class="fu">tm_lines</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-255-1.png" width="672" /></p>
<p>For polygons, we can use <code>tm_polygons()</code>, <code>tm_borders()</code>, or <code>tm_fill()</code>.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="creating-maps-in-r.html#cb416-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony) <span class="sc">+</span> <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="creating-maps-in-r.html#cb417-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony) <span class="sc">+</span> <span class="fu">tm_borders</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-256-2.png" width="672" /></p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="creating-maps-in-r.html#cb418-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony) <span class="sc">+</span> <span class="fu">tm_fill</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-256-3.png" width="672" /></p>
<p>For raster, we use the <code>tm_raster()</code> function.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="creating-maps-in-r.html#cb419-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span> <span class="fu">tm_raster</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-257-1.png" width="672" /></p>
<p>So far, we have only used the most basic functionality of <code>tmap</code>.
We have specified a single data set and used one visual element to populate the map.
Most visual elements have properties that we can adjust.
We have already seen this with <code>tm_symbols()</code>, where we specified the size and shape of symbols.
Those specifications are made within the brackets following the call to the visual element.
For example, if we want to set the size of our bubbles we use:</p>
</div>
<div id="adjusting-visual-elements-and-multiple-groups" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Adjusting visual elements and multiple groups<a href="creating-maps-in-r.html#adjusting-visual-elements-and-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="creating-maps-in-r.html#cb420-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
<p>These attributes can either be fixed or variable.
So far we have only used fixed attributes (e.g., all points have the size 2).
Variable attributes follow variables of the data set.
We could for example control the color of the points by the electrical conductivity.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="creating-maps-in-r.html#cb421-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">col =</span> <span class="st">&quot;EC&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-259-1.png" width="672" /></p>
<p>As you can see, we the name of the variable, we want to use, needs to be provided in quotation marks.
Since the electrical conductivity is a numerical variable, <code>tmap</code> automatically chooses a continuous color scale.
If we transform EC into a factor variable or a character, <code>tmap</code> would use a categorical color scale.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="creating-maps-in-r.html#cb422-1" tabindex="-1"></a>lucas <span class="ot">&lt;-</span> <span class="fu">mutate</span>(lucas, <span class="at">EC_char =</span> <span class="fu">as.character</span>(EC))</span>
<span id="cb422-2"><a href="creating-maps-in-r.html#cb422-2" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">col =</span> <span class="st">&quot;EC_char&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Number of levels of the variable &quot;EC_char&quot; is 75, which is larger than max.categories (which is 30), so levels are combined. Set
## tmap_options(max.categories = 75) in the layer function to show all levels.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
<p>For point data we generally have the arguments: size, color, transparency (alpha), border color, line width, and transparency.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="creating-maps-in-r.html#cb424-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> </span>
<span id="cb424-2"><a href="creating-maps-in-r.html#cb424-2" tabindex="-1"></a>        <span class="fu">tm_bubbles</span>(<span class="at">col =</span> <span class="st">&quot;EC&quot;</span>,</span>
<span id="cb424-3"><a href="creating-maps-in-r.html#cb424-3" tabindex="-1"></a>                   <span class="at">size =</span> <span class="st">&quot;OC&quot;</span>,</span>
<span id="cb424-4"><a href="creating-maps-in-r.html#cb424-4" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb424-5"><a href="creating-maps-in-r.html#cb424-5" tabindex="-1"></a>                   <span class="at">border.col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb424-6"><a href="creating-maps-in-r.html#cb424-6" tabindex="-1"></a>                   <span class="at">border.lwd =</span> .<span class="dv">5</span>, </span>
<span id="cb424-7"><a href="creating-maps-in-r.html#cb424-7" tabindex="-1"></a>                   <span class="at">border.alpha =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-261-1.png" width="672" /></p>
<p>For line data, we can determine the line width, color, type, and transparency.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="creating-maps-in-r.html#cb425-1" tabindex="-1"></a><span class="fu">tm_shape</span>(rivers) <span class="sc">+</span></span>
<span id="cb425-2"><a href="creating-maps-in-r.html#cb425-2" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb425-3"><a href="creating-maps-in-r.html#cb425-3" tabindex="-1"></a>                 <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb425-4"><a href="creating-maps-in-r.html#cb425-4" tabindex="-1"></a>                 <span class="at">lwd =</span> .<span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
<p>For polygons, we have similar options.
We can alter color and border type.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="creating-maps-in-r.html#cb426-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony) <span class="sc">+</span> </span>
<span id="cb426-2"><a href="creating-maps-in-r.html#cb426-2" tabindex="-1"></a>        <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&quot;NAME_2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb426-3"><a href="creating-maps-in-r.html#cb426-3" tabindex="-1"></a>        <span class="fu">tm_borders</span>(<span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb426-4"><a href="creating-maps-in-r.html#cb426-4" tabindex="-1"></a>                   <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb426-5"><a href="creating-maps-in-r.html#cb426-5" tabindex="-1"></a>                   <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<p>As you can see, we can add multiple visual elements based on the same shape.
We can also have mutliple shapes in the same map.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="creating-maps-in-r.html#cb427-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span> </span>
<span id="cb427-2"><a href="creating-maps-in-r.html#cb427-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb427-3"><a href="creating-maps-in-r.html#cb427-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(<span class="fu">st_union</span>(saxony)) <span class="sc">+</span> </span>
<span id="cb427-4"><a href="creating-maps-in-r.html#cb427-4" tabindex="-1"></a>        <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb427-5"><a href="creating-maps-in-r.html#cb427-5" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb427-6"><a href="creating-maps-in-r.html#cb427-6" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb427-7"><a href="creating-maps-in-r.html#cb427-7" tabindex="-1"></a>        <span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> </span>
<span id="cb427-8"><a href="creating-maps-in-r.html#cb427-8" tabindex="-1"></a>        <span class="fu">tm_bubbles</span>(<span class="at">col =</span> <span class="st">&quot;EC&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">size =</span> .<span class="dv">2</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
<p>The combination of shape and visual element is called a group.
As you have just seen each map can have multiple groups and each group can have multiple visual elements.</p>
</div>
<div id="map-extend" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Map extend<a href="creating-maps-in-r.html#map-extend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The map uses the extend and projection of the first group, i.e. the data set that is specified in the first call to <code>tm_shape()</code>.</p>
<p>This can be changed by explicitly specifying the master shape with <code>is.master</code>.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="creating-maps-in-r.html#cb428-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span> </span>
<span id="cb428-2"><a href="creating-maps-in-r.html#cb428-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb428-3"><a href="creating-maps-in-r.html#cb428-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(<span class="fu">st_union</span>(saxony)) <span class="sc">+</span> </span>
<span id="cb428-4"><a href="creating-maps-in-r.html#cb428-4" tabindex="-1"></a>        <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb428-5"><a href="creating-maps-in-r.html#cb428-5" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb428-6"><a href="creating-maps-in-r.html#cb428-6" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb428-7"><a href="creating-maps-in-r.html#cb428-7" tabindex="-1"></a>        <span class="fu">tm_shape</span>(lucas, <span class="at">is.master=</span> T) <span class="sc">+</span> </span>
<span id="cb428-8"><a href="creating-maps-in-r.html#cb428-8" tabindex="-1"></a>        <span class="fu">tm_bubbles</span>(<span class="at">col =</span> <span class="st">&quot;EC&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">size =</span> .<span class="dv">2</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-265-1.png" width="672" /></p>
<p>Alternatively, the projection and extend can also be set manually.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="creating-maps-in-r.html#cb429-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">projection  =</span> <span class="dv">8857</span>) <span class="sc">+</span> </span>
<span id="cb429-2"><a href="creating-maps-in-r.html#cb429-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb429-3"><a href="creating-maps-in-r.html#cb429-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb429-4"><a href="creating-maps-in-r.html#cb429-4" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="creating-maps-in-r.html#cb430-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">bbox =</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">+</span> </span>
<span id="cb430-2"><a href="creating-maps-in-r.html#cb430-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb430-3"><a href="creating-maps-in-r.html#cb430-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb430-4"><a href="creating-maps-in-r.html#cb430-4" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="creating-maps-in-r.html#cb431-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">bbox =</span> <span class="st">&quot;Bautzen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb431-2"><a href="creating-maps-in-r.html#cb431-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb431-3"><a href="creating-maps-in-r.html#cb431-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb431-4"><a href="creating-maps-in-r.html#cb431-4" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-267-2.png" width="672" /></p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="creating-maps-in-r.html#cb432-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">bbox =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">14</span>, <span class="fl">50.8</span>, <span class="fl">51.3</span>)) <span class="sc">+</span> </span>
<span id="cb432-2"><a href="creating-maps-in-r.html#cb432-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb432-3"><a href="creating-maps-in-r.html#cb432-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb432-4"><a href="creating-maps-in-r.html#cb432-4" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-267-3.png" width="672" /></p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="creating-maps-in-r.html#cb433-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">bbox =</span> lucas) <span class="sc">+</span> </span>
<span id="cb433-2"><a href="creating-maps-in-r.html#cb433-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb433-3"><a href="creating-maps-in-r.html#cb433-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb433-4"><a href="creating-maps-in-r.html#cb433-4" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-267-4.png" width="672" /></p>
<p>We can use place names, coordinates, or other data sets to set the map limits.</p>
</div>
<div id="further-map-elements" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Further map elements<a href="creating-maps-in-r.html#further-map-elements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are additional elements we can add to our map.
Good maps should always have a north arrow and a scale bar.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="creating-maps-in-r.html#cb434-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">bbox =</span> <span class="st">&quot;Saxony&quot;</span>) <span class="sc">+</span> </span>
<span id="cb434-2"><a href="creating-maps-in-r.html#cb434-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb434-3"><a href="creating-maps-in-r.html#cb434-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb434-4"><a href="creating-maps-in-r.html#cb434-4" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb434-5"><a href="creating-maps-in-r.html#cb434-5" tabindex="-1"></a>        <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb434-6"><a href="creating-maps-in-r.html#cb434-6" tabindex="-1"></a>        <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
<p>Further elements are graticules and credits.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="creating-maps-in-r.html#cb435-1" tabindex="-1"></a><span class="fu">tm_graticules</span>() <span class="sc">+</span> </span>
<span id="cb435-2"><a href="creating-maps-in-r.html#cb435-2" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem, <span class="at">bbox =</span> <span class="st">&quot;Saxony&quot;</span>) <span class="sc">+</span> </span>
<span id="cb435-3"><a href="creating-maps-in-r.html#cb435-3" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb435-4"><a href="creating-maps-in-r.html#cb435-4" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb435-5"><a href="creating-maps-in-r.html#cb435-5" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb435-6"><a href="creating-maps-in-r.html#cb435-6" tabindex="-1"></a>        <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb435-7"><a href="creating-maps-in-r.html#cb435-7" tabindex="-1"></a>        <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb435-8"><a href="creating-maps-in-r.html#cb435-8" tabindex="-1"></a>        <span class="fu">tm_credits</span>(<span class="st">&quot;Jonathan Jupke, 2023&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-269-1.png" width="672" /></p>
</div>
<div id="making-the-map-prettier" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Making the map prettier<a href="creating-maps-in-r.html#making-the-map-prettier" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far we have only been concerned with putting data on our map.
Like all plots however, maps should convey their message and be nice to look at.
Your readers will have to spend more effort trying to understand an ugly map.
Generally, nicer figures are not only better in getting across your message.
They also convey a general sense of care - nice figures show that you put thought and effort into your document.</p>
<p>The maps we have created thus far do not convey this impression.<br />
To fix this, we need to address the background.
There are two options: using a base map or a background color.
The latter is easier, so I will show it first.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="creating-maps-in-r.html#cb436-1" tabindex="-1"></a><span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span> </span>
<span id="cb436-2"><a href="creating-maps-in-r.html#cb436-2" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb436-3"><a href="creating-maps-in-r.html#cb436-3" tabindex="-1"></a>        <span class="fu">tm_layout</span>(<span class="at">bg.color =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<p>Background colors can be an easy solution.
They can however, also invoke false impressions.
The above map, for example, makes it seem like Saxony is an island.</p>
<p>Base maps are maps on which your data is drawn.
They are usually rasters and can be downloaded from multiple sources.
Here, we will use the <code>maptiles</code> package <span class="citation">(<a href="#ref-Giraud2022">Giraud 2022</a>)</span>.
This package basically has just one function: <code>get_tiles()</code>.
That function downloads a base map for you.
We provide a spatial object (sf, sfc, bbox, SpatRaster, SpatVerctor, or SpatExtent object) to its <code>x</code> argument, the base map style we would like to the <code>provider</code> arguments (see <a href="https://rgeomatic.hypotheses.org/2032">here</a> for examples), and the level of detail to the <code>zoom</code> argument.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="creating-maps-in-r.html#cb437-1" tabindex="-1"></a><span class="fu">library</span>(maptiles)</span>
<span id="cb437-2"><a href="creating-maps-in-r.html#cb437-2" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">get_tiles</span>(<span class="at">x =</span> saxony_dem, </span>
<span id="cb437-3"><a href="creating-maps-in-r.html#cb437-3" tabindex="-1"></a>          <span class="at">provider =</span> <span class="st">&quot;Esri.WorldImagery&quot;</span>, </span>
<span id="cb437-4"><a href="creating-maps-in-r.html#cb437-4" tabindex="-1"></a>          <span class="at">zoom =</span> <span class="dv">8</span>,</span>
<span id="cb437-5"><a href="creating-maps-in-r.html#cb437-5" tabindex="-1"></a>          <span class="at">crop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="creating-maps-in-r.html#cb438-1" tabindex="-1"></a><span class="fu">tm_shape</span>(bm) <span class="sc">+</span></span>
<span id="cb438-2"><a href="creating-maps-in-r.html#cb438-2" tabindex="-1"></a>        <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb438-3"><a href="creating-maps-in-r.html#cb438-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span></span>
<span id="cb438-4"><a href="creating-maps-in-r.html#cb438-4" tabindex="-1"></a>        <span class="fu">tm_raster</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-272-1.png" width="672" /></p>
<p>Second, the legend is often covering parts of the map. We can avoid this by moving it outside.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="creating-maps-in-r.html#cb439-1" tabindex="-1"></a><span class="fu">tm_shape</span>(bm) <span class="sc">+</span></span>
<span id="cb439-2"><a href="creating-maps-in-r.html#cb439-2" tabindex="-1"></a>        <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb439-3"><a href="creating-maps-in-r.html#cb439-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span></span>
<span id="cb439-4"><a href="creating-maps-in-r.html#cb439-4" tabindex="-1"></a>        <span class="fu">tm_raster</span>() <span class="sc">+</span> </span>
<span id="cb439-5"><a href="creating-maps-in-r.html#cb439-5" tabindex="-1"></a>        <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
<p>Lastly, the color scale is rather unusual for a DEM.
Here we use nicer colors and also add all the other elements to the map.
You can have a look at all the palettes available to <code>tmap</code> if you call <code>tmaptools::palette_explorer()</code>.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="creating-maps-in-r.html#cb440-1" tabindex="-1"></a><span class="fu">tm_shape</span>(bm) <span class="sc">+</span></span>
<span id="cb440-2"><a href="creating-maps-in-r.html#cb440-2" tabindex="-1"></a>        <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb440-3"><a href="creating-maps-in-r.html#cb440-3" tabindex="-1"></a>        <span class="fu">tm_shape</span>(saxony_dem) <span class="sc">+</span></span>
<span id="cb440-4"><a href="creating-maps-in-r.html#cb440-4" tabindex="-1"></a>        <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">terrain.colors</span>(<span class="at">n =</span> <span class="dv">20</span>), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">title =</span> <span class="st">&quot;Elevation [m]&quot;</span>) <span class="sc">+</span> </span>
<span id="cb440-5"><a href="creating-maps-in-r.html#cb440-5" tabindex="-1"></a>        <span class="fu">tm_shape</span>(rivers) <span class="sc">+</span> </span>
<span id="cb440-6"><a href="creating-maps-in-r.html#cb440-6" tabindex="-1"></a>        <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-7"><a href="creating-maps-in-r.html#cb440-7" tabindex="-1"></a>        <span class="fu">tm_shape</span>(lucas) <span class="sc">+</span> </span>
<span id="cb440-8"><a href="creating-maps-in-r.html#cb440-8" tabindex="-1"></a>        <span class="fu">tm_dots</span>(<span class="at">size =</span> .<span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;EC&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;inferno&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Electrical Conductivity [μS]&quot;</span>) <span class="sc">+</span> </span>
<span id="cb440-9"><a href="creating-maps-in-r.html#cb440-9" tabindex="-1"></a>        <span class="fu">tm_compass</span>() <span class="sc">+</span> </span>
<span id="cb440-10"><a href="creating-maps-in-r.html#cb440-10" tabindex="-1"></a>        <span class="fu">tm_scale_bar</span>() <span class="sc">+</span> </span>
<span id="cb440-11"><a href="creating-maps-in-r.html#cb440-11" tabindex="-1"></a>        <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb440-12"><a href="creating-maps-in-r.html#cb440-12" tabindex="-1"></a>                  <span class="at">main.title =</span> <span class="st">&quot;Electrical Conductivity in Saxony&quot;</span></span>
<span id="cb440-13"><a href="creating-maps-in-r.html#cb440-13" tabindex="-1"></a>                  ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-274-1.png" width="672" /></p>
<p>It can also be nice to create maps with an inset, i.e. maps that include a smaller map that shows the larger context of the map. This is possible with <code>tmap</code> but extends beyond the scope of this chapter.
See <a href="https://ecodiv.earth/post/creating-a-map-with-inset-using-tmap/">here</a> for a tutorial.</p>
</div>
<div id="save-to-maps-to-file" class="section level3 hasAnchor" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> Save to maps to file<a href="creating-maps-in-r.html#save-to-maps-to-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can save tmap objects to file with the <code>tmap_save()</code> function.</p>
</div>
</div>
<div id="rastervis" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> rasterVis<a href="creating-maps-in-r.html#rastervis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we will explore the basic functionality of the <code>rasterVis</code> package.
As the name already suggests, the purpose of this package is to display raster data.
While the common R packages to work with rasters, like <code>raster</code> or <code>terra</code> (see chapter 6)), already provide basic plotting functionality, <code>rasterVis</code> extends this substantially.
You can find a more extensive documentation for the package <a href="https://oscarperpinan.github.io/rastervis/">here</a>.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="creating-maps-in-r.html#cb441-1" tabindex="-1"></a><span class="fu">library</span>(rasterVis)</span>
<span id="cb441-2"><a href="creating-maps-in-r.html#cb441-2" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div>
<p>First we need to load some rasters.
We will use the <code>geodata</code> package (see next chapter) to download a digital elevation model of Austria.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="creating-maps-in-r.html#cb442-1" tabindex="-1"></a>dem_austria <span class="ot">&lt;-</span> geodata<span class="sc">::</span><span class="fu">elevation_30s</span>(<span class="at">country =</span> <span class="st">&quot;Austria&quot;</span>, <span class="at">path =</span> <span class="st">&quot;data/&quot;</span>)</span></code></pre></div>
<p>In addition, I want to show you how changes over time can be displayed.
So we will also need spatio-temporal data.
Below, we download and load solar irradiance data from the Satellite Application Facility on Climate Monitoring (<a href="https://www.cmsaf.eu/">CMSAF</a>).
There are a series of packages that you could also use specifically to access these data, for example the <a href="https://cran.r-project.org/web/packages/cmsaf/index.html">cmsaf</a> package.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="creating-maps-in-r.html#cb443-1" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&#39;https://raw.github.com/oscarperpinan/spacetime-vis/master/data/SISmm2008_CMSAF.zip&#39;</span>,</span>
<span id="cb443-2"><a href="creating-maps-in-r.html#cb443-2" tabindex="-1"></a>              <span class="st">&#39;SISmm2008_CMSAF.zip&#39;</span>)</span>
<span id="cb443-3"><a href="creating-maps-in-r.html#cb443-3" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">&#39;SISmm2008_CMSAF.zip&#39;</span>)</span>
<span id="cb443-4"><a href="creating-maps-in-r.html#cb443-4" tabindex="-1"></a>listFich <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">pattern=</span><span class="st">&#39;</span><span class="sc">\\</span><span class="st">.nc&#39;</span>)</span>
<span id="cb443-5"><a href="creating-maps-in-r.html#cb443-5" tabindex="-1"></a>stackSIS <span class="ot">&lt;-</span> <span class="fu">stack</span>(listFich)</span>
<span id="cb443-6"><a href="creating-maps-in-r.html#cb443-6" tabindex="-1"></a>stackSIS <span class="ot">&lt;-</span> stackSIS <span class="sc">*</span> <span class="dv">24</span> <span class="do">##from irradiance (W/m2) to irradiation Wh/m2</span></span>
<span id="cb443-7"><a href="creating-maps-in-r.html#cb443-7" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&#39;2008-01-15&#39;</span>), <span class="fu">as.Date</span>(<span class="st">&#39;2008-12-15&#39;</span>), <span class="st">&#39;month&#39;</span>)</span>
<span id="cb443-8"><a href="creating-maps-in-r.html#cb443-8" tabindex="-1"></a>SISmm <span class="ot">&lt;-</span> <span class="fu">setZ</span>(stackSIS, idx)</span>
<span id="cb443-9"><a href="creating-maps-in-r.html#cb443-9" tabindex="-1"></a><span class="fu">names</span>(SISmm) <span class="ot">&lt;-</span> month.abb</span></code></pre></div>
<pre><code>## Lade nötigen Namensraum: ncdf4</code></pre>
<p>Ok, with that we can start plotting the data.
The basic plotting function in <code>rasterVis</code> is called <code>levelplot()</code>. If we use that with our Austrian DEM and the irradiance data we get these plots:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="creating-maps-in-r.html#cb445-1" tabindex="-1"></a><span class="fu">levelplot</span>(dem_austria)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="creating-maps-in-r.html#cb446-1" tabindex="-1"></a><span class="fu">levelplot</span>(SISmm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
<p>As you can see, the second plot does not have plots in the margins like the first one.
<code>levelplot()</code> only creates marginal plots for rasters with a single layer.
If we select one layer, the solar irradiance plots also include these marginal plots.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="creating-maps-in-r.html#cb447-1" tabindex="-1"></a><span class="fu">levelplot</span>(SISmm, <span class="at">layers =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<p>By default these plots show the means of their respective column or row but we can change this to any function we like.
In the plot below, for example, we see the minimal altitude not the mean altitude in the margins.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="creating-maps-in-r.html#cb448-1" tabindex="-1"></a><span class="fu">levelplot</span>(dem_austria,<span class="at">margin =</span> <span class="fu">list</span>(<span class="at">FUN =</span> <span class="st">&#39;min&#39;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-284-1.png" width="672" /></p>
<p>We can also alter the raster values directly in the call to <code>levelplot()</code>.
For example, we can display the logarithm (with base e) by adding the argument: <code>zscaleLog="e"</code>. In this plot, we also add contour lines.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="creating-maps-in-r.html#cb449-1" tabindex="-1"></a><span class="fu">levelplot</span>(dem_austria, <span class="at">zscaleLog=</span><span class="st">&quot;e&quot;</span>, <span class="at">contour=</span><span class="cn">TRUE</span>, <span class="at">margin=</span><span class="fu">list</span>(<span class="at">FUN =</span> <span class="st">&quot;min&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
<p>You might have noticed that sofar all plots have used the same colors (magma palette from the <a href="https://github.com/sjmgarnier/viridisLite">viridisLite package</a>).
We can easily change this to other palettes:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="creating-maps-in-r.html#cb450-1" tabindex="-1"></a><span class="fu">levelplot</span>(dem_austria, <span class="at">par.settings =</span> RdBuTheme)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-286-1.png" width="672" /></p>
<p>Alternative palettes are; viridisTheme, infernoTheme, plasmaTheme, YlOrRdTheme, BuRdTheme, GrTheme and BTCTheme.</p>
<div id="beyond-the-usual" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Beyond the usual<a href="creating-maps-in-r.html#beyond-the-usual" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All of this is very nice but merely a small extension of what <code>raster</code> or <code>terra</code> can already do.
However, <code>rasterVis</code> has some more tricks up its sleeve.
Like the <code>xyplot()</code> you can see below.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="creating-maps-in-r.html#cb451-1" tabindex="-1"></a><span class="fu">xyplot</span>(Jan<span class="sc">+</span>Feb<span class="sc">~</span>Jul<span class="sc">|</span><span class="fu">cut</span>(x, <span class="dv">2</span>), <span class="at">data =</span> SISmm, <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">space=</span><span class="st">&#39;right&#39;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-287-1.png" width="672" />
In the function call there are three building blocks: 1. <code>Jan+Feb~Jul|cut(x, 2)</code>; 2. <code>data = SISmm</code>; 3. <code>auto.key = list(space='right')</code>.
The latter two require less explanation so we will start with them.
The data argument receives the raster you want to plot.
The auto.key, at least here, is only there to receive the position of the legend.
The first argument is written in R’s formula notation.
You probably know it from fitting models in R, e.g. <code>lm(x ~ y + z)</code>.
The response (Jan+Feb) is displayed on the Y-axis and the predictor (Jul) on the X-axis. Each dot in the scatter plot is one cell value of <code>SISmm</code>. <code>|cut(x,2)</code> indicates that we want to split the X-axis into two distinct plots. The values on top of the two plots indicate the X-range for each of them.</p>
<p>One drawback of this plot is that many points are on top of each other. A density plot would be helpful for that and indeed <code>rasterVis</code> provides hexbinplots just for that. Note that we have to drop the second response variable in the hexbinplot.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="creating-maps-in-r.html#cb452-1" tabindex="-1"></a><span class="fu">hexbinplot</span>(Jan<span class="sc">~</span>Jul<span class="sc">|</span><span class="fu">cut</span>(x, <span class="dv">2</span>), <span class="at">data =</span> SISmm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-288-1.png" width="672" /></p>
<p>Lastly, <code>rasterVis</code> makes it easy to make four common exploratory plots for the raster cell values: 1. scatter plot matrices (splom), 2. histograms, 3. densityplots and box and whiskers plots.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="creating-maps-in-r.html#cb453-1" tabindex="-1"></a><span class="fu">splom</span>(SISmm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-289-1.png" width="672" /></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="creating-maps-in-r.html#cb454-1" tabindex="-1"></a><span class="fu">histogram</span>(SISmm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="creating-maps-in-r.html#cb455-1" tabindex="-1"></a><span class="fu">densityplot</span>(SISmm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="creating-maps-in-r.html#cb456-1" tabindex="-1"></a><span class="fu">bwplot</span>(SISmm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
</div>
<div id="cartographer" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Cartographer<a href="creating-maps-in-r.html#cartographer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section will be added soon</p>
</div>
<div id="rayshader" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Rayshader<a href="creating-maps-in-r.html#rayshader" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this entry we will go through the basics of <strong>rayshader</strong>.
Rayshader is one of those packages that you see again and again when you follow people from the R-spatial community on twitter.
Especially the package’s creator Tyler Morgan-Wall (see <a href="https://www.tylermw.com/">here</a> for his website and <a href="https://twitter.com/tylermorganwall">here</a> for his Twitter) posts videos and images of things he did with it on an almost daily basis.
And he has all the reasons to do so.
I don’t know any other package that enables you to create such stunning 3D graphics with R.
If you have never seen this package before I am quite sure you are going to be surprised by what is possible.</p>
<div id="setup" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Setup<a href="creating-maps-in-r.html#setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First things first, we need to install and load the <strong>rayshader</strong> package, as well as some other packages we will need along the way.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="creating-maps-in-r.html#cb457-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rayshader&quot;</span>)</span>
<span id="cb457-2"><a href="creating-maps-in-r.html#cb457-2" tabindex="-1"></a><span class="fu">library</span>(rayshader)</span>
<span id="cb457-3"><a href="creating-maps-in-r.html#cb457-3" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb457-4"><a href="creating-maps-in-r.html#cb457-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<p>We will use an example raster file from Tyler Morgan-Walls website.
We can download the files with the following code:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="creating-maps-in-r.html#cb458-1" tabindex="-1"></a>loadzip <span class="ot">=</span> <span class="fu">tempfile</span>()</span>
<span id="cb458-2"><a href="creating-maps-in-r.html#cb458-2" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://tylermw.com/data/dem_01.tif.zip&quot;</span>, loadzip)</span>
<span id="cb458-3"><a href="creating-maps-in-r.html#cb458-3" tabindex="-1"></a>localtif <span class="ot">=</span> <span class="fu">raster</span>(<span class="fu">unzip</span>(loadzip, <span class="st">&quot;dem_01.tif&quot;</span>))</span>
<span id="cb458-4"><a href="creating-maps-in-r.html#cb458-4" tabindex="-1"></a><span class="fu">unlink</span>(loadzip)</span></code></pre></div>
<p>Before we do anything fancy let’s have look at our new raster.
It is a DEM with 505 rows and 550 columns and each cell has size of 33.3m * 33.3m.
There are strong differences in height here, from 0 to 971m.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="creating-maps-in-r.html#cb459-1" tabindex="-1"></a>localtif</span></code></pre></div>
<pre><code>## class      : RasterLayer 
## dimensions : 505, 550, 277750  (nrow, ncol, ncell)
## resolution : 33.36518, 33.36518  (x, y)
## extent     : 505010.3, 523361.2, 5258284, 5275133  (xmin, xmax, ymin, ymax)
## crs        : +proj=utm +zone=55 +south +ellps=GRS80 +units=m +no_defs 
## source     : dem_01.tif 
## names      : dem_01 
## values     : 0, 971  (min, max)</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="creating-maps-in-r.html#cb461-1" tabindex="-1"></a><span class="fu">plot</span>(localtif)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-297-1.png" width="672" /></p>
<p>To work with *rayshader** we will need to transform this to a matrix with the <code>raster_to_matrix()</code> function.
Then we can start with add a specific <span style="color:CornflowerBlue">texture</span> as well as shadows.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="creating-maps-in-r.html#cb462-1" tabindex="-1"></a>elmat <span class="ot">=</span> <span class="fu">raster_to_matrix</span>(localtif)</span></code></pre></div>
<pre><code>## [1] &quot;Dimensions of matrix are: 505x550&quot;</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="creating-maps-in-r.html#cb464-1" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb464-2"><a href="creating-maps-in-r.html#cb464-2" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb464-3"><a href="creating-maps-in-r.html#cb464-3" tabindex="-1"></a>  <span class="fu">plot_map</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-298-1.png" width="672" />
The shadows are computed for a default sun angle, but we can change that angle if we like.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="creating-maps-in-r.html#cb465-1" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb465-2"><a href="creating-maps-in-r.html#cb465-2" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">sunangle =</span> <span class="dv">45</span>, <span class="at">texture =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb465-3"><a href="creating-maps-in-r.html#cb465-3" tabindex="-1"></a>  <span class="fu">plot_map</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-299-1.png" width="672" /></p>
<p>Now you might have noticed that the areas in the valley look suspiciously flat.
That’s because they are water surfaces.
With the two functions <code>detect_water()</code> and <code>add_water()</code> we can add water to our map.
<code>detect_water()</code> returns a binary matrix with the same dimensions as <code>elmat</code>.
A one indicates that the corresponding cell in <code>elmat</code> contains water and a zero that the cell does not.
With the <span style="color:CornflowerBlue">cutoff</span> argument you can specify how high the water should be, i.e. which cells are classified as carrying water.
High values mean lower water level.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="creating-maps-in-r.html#cb466-1" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb466-2"><a href="creating-maps-in-r.html#cb466-2" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-3"><a href="creating-maps-in-r.html#cb466-3" tabindex="-1"></a>  <span class="fu">add_water</span>(<span class="fu">detect_water</span>(elmat, <span class="at">cutoff =</span> <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-4"><a href="creating-maps-in-r.html#cb466-4" tabindex="-1"></a>  <span class="fu">plot_map</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
<p>Now we don’t have any shadows on the water yet.
But that can be done with <code>add_shadow()</code>.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="creating-maps-in-r.html#cb467-1" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb467-2"><a href="creating-maps-in-r.html#cb467-2" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb467-3"><a href="creating-maps-in-r.html#cb467-3" tabindex="-1"></a>  <span class="fu">add_water</span>(<span class="fu">detect_water</span>(elmat), <span class="at">color =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb467-4"><a href="creating-maps-in-r.html#cb467-4" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ray_shade</span>(elmat), <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb467-5"><a href="creating-maps-in-r.html#cb467-5" tabindex="-1"></a>  <span class="fu">plot_map</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-301-1.png" width="672" /></p>
<p>In addition to rayshade we can also ad ambient shade, to make it look even better.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="creating-maps-in-r.html#cb468-1" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb468-2"><a href="creating-maps-in-r.html#cb468-2" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb468-3"><a href="creating-maps-in-r.html#cb468-3" tabindex="-1"></a>  <span class="fu">add_water</span>(<span class="fu">detect_water</span>(elmat), <span class="at">color =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb468-4"><a href="creating-maps-in-r.html#cb468-4" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ray_shade</span>(elmat), <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb468-5"><a href="creating-maps-in-r.html#cb468-5" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ambient_shade</span>(elmat), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb468-6"><a href="creating-maps-in-r.html#cb468-6" tabindex="-1"></a>  <span class="fu">plot_map</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
<p>All this was only the preparation though for the 3D capabilities of <strong>rayshader</strong>.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="creating-maps-in-r.html#cb469-1" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb469-2"><a href="creating-maps-in-r.html#cb469-2" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-3"><a href="creating-maps-in-r.html#cb469-3" tabindex="-1"></a>  <span class="fu">add_water</span>(<span class="fu">detect_water</span>(elmat), <span class="at">color =</span> <span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-4"><a href="creating-maps-in-r.html#cb469-4" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ray_shade</span>(elmat, <span class="at">zscale =</span> <span class="dv">3</span>), <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-5"><a href="creating-maps-in-r.html#cb469-5" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ambient_shade</span>(elmat), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-6"><a href="creating-maps-in-r.html#cb469-6" tabindex="-1"></a>  <span class="fu">plot_3d</span>(elmat, <span class="at">zscale =</span> <span class="dv">10</span>, <span class="at">fov =</span> <span class="dv">0</span>, <span class="at">theta =</span> <span class="dv">135</span>, <span class="at">zoom =</span> <span class="fl">0.75</span>, <span class="at">phi =</span> <span class="dv">45</span>, <span class="at">windowsize =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">800</span>))</span>
<span id="cb469-7"><a href="creating-maps-in-r.html#cb469-7" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="fl">0.2</span>)</span>
<span id="cb469-8"><a href="creating-maps-in-r.html#cb469-8" tabindex="-1"></a><span class="fu">render_snapshot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-303-1.png" width="672" /></p>
<p>This package can do much more than we discussed here or than is really useful for scientific purposes.
See <a href="https://www.rayshader.com/">here</a> for more extensive coverage.</p>

</div>
</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Giraud2022" class="csl-entry">
Giraud, Timothée. 2022. <em>Maptiles: Download and Display Map Tiles</em>. <a href="https://CRAN.R-project.org/package=maptiles">https://CRAN.R-project.org/package=maptiles</a>.
</div>
<div id="ref-Hijmans2022b" class="csl-entry">
Hijmans, Robert J., Aniruddha Ghosh, and Alex Mandel. 2022. <em>Geodata: Download Geographic Data</em>. <a href="https://CRAN.R-project.org/package=geodata">https://CRAN.R-project.org/package=geodata</a>.
</div>
<div id="ref-Tennekes2018" class="csl-entry">
Tennekes, Martijn. 2018. <span>“<span class="nocase">tmap</span>: Thematic Maps in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 84 (6): 1–39. <a href="https://doi.org/10.18637/jss.v084.i06">https://doi.org/10.18637/jss.v084.i06</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rasters-in-r-the-terra-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="where-do-i-get-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-Maps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
